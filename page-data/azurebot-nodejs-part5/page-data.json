{"componentChunkName":"component---packages-blog-gatsby-blog-core-src-templates-post-js","path":"/azurebot-nodejs-part5/","result":{"data":{"post":{"id":"31e75b40-8c93-54fb-bbfe-58e742083902","title":"Bot Framework in Node.js - Auth and Microsoft Graph (part 5)","slug":"/azurebot-nodejs-part5/","link":null,"excerpt":"In the previous post, we had a look at user interruptions. In this post, we will look at how to…","tableOfContents":{"items":[{"items":[{"url":"#what-we-will-build-today","title":"What we will build today"}]},{"url":"#sourcecode","title":"Sourcecode"},{"url":"#prerequisites","title":"Prerequisites"},{"url":"#register-a-new-azure-ad-application","title":"Register a new Azure AD Application","items":[{"url":"#using-azure-cli","title":"Using Azure CLI"},{"url":"#using-the-portal","title":"Using the portal"}]},{"url":"#project-changes","title":"Project changes","items":[{"url":"#botts","title":"bot.ts"},{"url":"#maindialog","title":"mainDialog"}]},{"url":"#adding-the-possibility-to-log-out","title":"Adding the possibility to log out"},{"url":"#test-login","title":"Test login","items":[{"url":"#login-in-teams","title":"Login in Teams"}]},{"url":"#next-step","title":"Next step"}]},"timeToRead":3,"featured":null,"protected":null,"thumbnailText":null,"date":"March 13, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"body":"var _excluded = [\"components\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (-1 !== e.indexOf(n)) continue; t[n] = r[n]; } return t; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"Bot Framework in Node.js - Auth and Microsoft Graph (part 5)\",\n  \"tags\": [\"botframework\", \"teams\", \"msgraph\"],\n  \"thumbnail\": \"botframework5.png\",\n  \"author\": \"Simon Ågren\",\n  \"date\": \"2020-03-13T00:00:00.000Z\",\n  \"category\": \"Azure\",\n  \"slug\": \"azurebot-nodejs-part5\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"In the previous post, we had a look at user interruptions.\"), mdx(\"p\", null, \"In this post, we will look at how to secure the Bot and give the user the ability to log in (and out) and then call Microsoft Graph. We will utilize the Azure Bot service built-in authentication abilities.\"), mdx(\"table\", null, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Bot Framework in Node.js\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Complimentary post\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azurebot-nodejs-part1\",\n    target: \"_blank\"\n  }, \"Let\\u2019s begin (Part 1)\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azurebot-armtemplate-keyvault\",\n    target: \"_blank\"\n  }, \"Bot Framework 4 ARM template Deploy with Key Vault\"))), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azurebot-nodejs-part2\",\n    target: \"_blank\"\n  }, \"Microsoft Teams (Part 2)\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  })), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azurebot-nodejs-part3\",\n    target: \"_blank\"\n  }, \"Dialogs (Part 3)\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  })), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azurebot-nodejs-part4\",\n    target: \"_blank\"\n  }, \"Interruptions (Part 4)\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  })), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Auth and Microsoft Graph (Part 5)\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azcli-adscope\",\n    target: \"_blank\"\n  }, \"Azure AD & Microsoft Graph permission scopes, with Azure CLI\"))), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azcli-connection\",\n    target: \"_blank\"\n  }, \"Azure AD & Microsoft Graph OAuth Connection, with Azure CLI\"))), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azurebot-nodejs-part6\",\n    target: \"_blank\"\n  }, \"Calling Microsoft Graph (Part 6)\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  })))), mdx(\"h2\", {\n    \"id\": \"what-we-will-build-today\"\n  }, \"What we will build today\"), mdx(\"img\", {\n    \"src\": \"/cdf547c737a9961c73f95762cd331b07/loginout.gif\"\n  }), mdx(\"h1\", {\n    \"id\": \"sourcecode\"\n  }, \"Sourcecode\"), mdx(\"p\", null, \"Here is the link to the Github repository for this post: \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/simonagren/simon-blog-bot-v5\"\n  }, \"https://github.com/simonagren/simon-blog-bot-v5\")), mdx(\"h1\", {\n    \"id\": \"prerequisites\"\n  }, \"Prerequisites\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://aka.ms/Emulator-wiki-getting-started\"\n  }, \"Bot Emulator\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://nodejs.org/en/download/\"\n  }, \"Node.js 10.4+\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://code.visualstudio.com/\"\n  }, \"Visual Studio Code\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://azure.microsoft.com/free/\"\n  }, \"An Azure Account\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://developer.microsoft.com/office/dev-program\"\n  }, \"Office 365 dev tenant\"), \" - for Microsoft Teams\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://ngrok.com/download\"\n  }, \"Ngrok\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://docs.microsoft.com/en-us/microsoftteams/platform/concepts/build-and-test/app-studio-overview#installing-app-studio\"\n  }, \"App Studio installed in Teams\"))), mdx(\"h1\", {\n    \"id\": \"register-a-new-azure-ad-application\"\n  }, \"Register a new Azure AD Application\"), mdx(\"p\", null, \"In the first post, we created an Azure AD App Registration, and that was for the channel authentication and making sure we don\\u2019t receive messages from somewhere we shouldn\\u2019t.\"), mdx(\"p\", null, \"The last time we used \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Azure CLI\"), \". It was less complicated since we just needed the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"appId\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"appSecret\"), \", we didn\\u2019t need to add any permission scopes.\\nIn this post, we will create the App registration and add the connection using the portal. \"), mdx(\"h2\", {\n    \"id\": \"using-azure-cli\"\n  }, \"Using Azure CLI\"), mdx(\"p\", null, \"I did make two additional posts as a \\u201Cbonus\\u201D to find the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"scopes\"), \" we want to use, create the AD Application with them, and then create the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"connection\"), \" from the Bot to the application - all by using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Azure CLI\"), \".\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azcli-adscope\",\n    target: \"_blank\"\n  }, \"Azure AD & Microsoft Graph permission scopes, with Azure CLI\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azcli-connection\",\n    target: \"_blank\"\n  }, \"Azure AD & Microsoft Graph OAuth Connection, with Azure CLI\"))), mdx(\"h2\", {\n    \"id\": \"using-the-portal\"\n  }, \"Using the portal\"), mdx(\"h3\", {\n    \"id\": \"register-ad-application\"\n  }, \"Register AD Application\"), mdx(\"p\", null, \"Go to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Azure Active Directory\"), \" blade in the Azure Portal, then \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"App registrations\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"New registration\"), \". Fill in the values and set the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"redirect URI\"), \" to \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, mdx(\"a\", {\n    parentName: \"strong\",\n    \"href\": \"https://token.botframework.com/.auth/web/redirect\"\n  }, \"https://token.botframework.com/.auth/web/redirect\")), \", then register. \"), mdx(\"p\", null, \"As always, take notes of the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"appId\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"tenantId\")), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"689px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"97.5438596491228%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACQElEQVQ4y51UCY7bMAzUc4t+qM9on9EvtGiKXcd2bFmST50+piBjp7uLzaaogAFFSx6K5EgiqzSeixq/S4VT0eCU1/iRSeR6gjYt8jxHVVXIsgxN08B7D2stnHPvQhijUZYFWqNRVxeURQHVSNwb27bhoyHWdUVKCY/GSx4ipf/eg3DThEZKhOA5He8dvHM8d9ayDX5fc47TXZbl/gkrM+KUS/w61/j5fEFWGxR6QKEGnGXHttz9vOlxli3UGNH5Ba37C+NmGJcgjJ1Rdw7NEFD3Dp1fMSagCyv6sL1GvIL2vCQ7CJVNEDEGTNPEqYQQYKeJ03vbiLfAneaIoe9ZDkppKKVQ1zX6vucAFCil+cOOv4WQQ0TXj0zSdR1aY9C2Lcxuh2G4kXMG1vK395TBhN3ooLVhAiLVWkNKCaUaaKXYp5NTFgQKSrolS92e5/kGTjkFz0JuZM0/lGXJadMpCOM4YppGthSQ6ktkx9oBOvmVcNlgw4wpJMSUOBIJ9H8Gp+zmjWUyxg3bg4IfoID31kSKEcE7zDHwTXDeP7yvH95lasalqtAohcvlwhj2mhyvCnX4sPTtqNnxwhzrVC5BBaYnihpBoKacz2cGkZNfFAX7NKe9T09PbAmkCCIkxBghrL06VJdlmbEuC9sYAoah33VpbrqkAxDIp6ePSNZdPiF6iJdaoi77mBAIaX6FmK57lj3g1b7WIflCTjOyLiFrEwxf8oUv/zE/MITln5olvnzX+PS1wOdvBZSdH76y2wP8ARDdD/pKP122AAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"register\",\n    \"title\": \"register\",\n    \"src\": \"/static/a1b9efe3875e6242b897853e9b01ac3b/0f79a/register.png\",\n    \"srcSet\": [\"/static/a1b9efe3875e6242b897853e9b01ac3b/0e2fe/register.png 285w\", \"/static/a1b9efe3875e6242b897853e9b01ac3b/432e7/register.png 570w\", \"/static/a1b9efe3875e6242b897853e9b01ac3b/0f79a/register.png 689w\"],\n    \"sizes\": \"(max-width: 689px) 100vw, 689px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"register\"), \"\\n  \")), mdx(\"p\", null, \"Create a new \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"never expiring\"), \" \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"secret\"), \" and make note of the value.\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"978px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"57.54385964912281%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABWklEQVQoz51TCW6DMBD0/5/Rf/QFeUKrChFIgBB8YxsbJlonILWNmqQrjQzrZXcGj1lZlqjrGkVRoO/7/FxVFQ6HA4QQWJYFaZ4xP0BKCd57sHEcMU1T/jDGmDfjFBC8yyuwvACAaaW+MXA+YN+ccRIGykXoMD+EodXPGKcZzFqbOxNDLAuMC/goG7TCQvkZwiXIJ7DWMas19dkihADBOVKK+E+w9niElALBe3g3Zsl+tEAKV+Y39s+C1VWF/b5E1zYYjQK3Ae+fBl+9QwweMaXXGkop4ZzbZHfK4213wq4QcEbnX5DS1RZ/gRxCYEqKzGINYmXOR8hzB2MsjDG/oLXOoAOld6XUZj1mtAJ5kTYpOcWIru/Rth34MOSpK4vVwPdMvdwkMqN1lkzSKEkFdEM453nAGrS3WozyVP8zMsOmaUCga0MziJHgIjclWbSSpGEYtoYrs3uHcgHZ5qlZWtYn1QAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"secret\",\n    \"title\": \"secret\",\n    \"src\": \"/static/bb60a1f197a24fbaabfa48a513f744a3/914c7/secret.png\",\n    \"srcSet\": [\"/static/bb60a1f197a24fbaabfa48a513f744a3/0e2fe/secret.png 285w\", \"/static/bb60a1f197a24fbaabfa48a513f744a3/432e7/secret.png 570w\", \"/static/bb60a1f197a24fbaabfa48a513f744a3/914c7/secret.png 978w\"],\n    \"sizes\": \"(max-width: 978px) 100vw, 978px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"secret\"), \"\\n  \")), mdx(\"p\", null, \"Under \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"API Permissions\"), \", we are going to add \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Microsoft Graph\"), \" delegated permission scopes. In this case, we added \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"openid\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"profile\"), \", and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Group.Read.All\"), \" (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"User.Read\"), \" was already there).\"), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Group.Read.All\"), \" require Admin consent. We don\\u2019t need it now, but I did want to prepare us for upcoming posts. Make sure you admin consent in whatever way you find feasible.\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"824px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"84.21052631578947%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB2klEQVQ4y6WUyXKcMBCG9f6Vc/Iuuebis+M9nhUGkARiGUALA3+qexY7tuNMTVT1VUsCdf+SWi2SNEWaSWRZBikllFJwziGEAO8923OhdSJtBmx7B+8dT/xvEz/nClppZGnKKquyRN1aDjKEgN1u937VNGH6C2IhNZ7WMZ6iBPNEYqVyLKXGPFVYyRxrbaBa2kGA8x7WOozjhGnv98TIdoJ4WMW4v7nGw/0tZr8esV7OsSIWMyaJ11jIAnG8QRRF0Fqjrmu0bfsH1tq9w7hssCkqRjXdO2TTIe88nPOskto4TazyyG6c0PuRrTDGQOc5yrKEDwHDMCAMA9u3fR6/utWXuQF15+DCAEGOtFIYx5Elk6WL+Az6hzLCFAULybWG7bv9likSTdIZHHOJPvyrHYMfBYx8y4Cg5M3znFOGHDdNg77v2TEnuPcnVedwcsgqnePXQY5IsTuMP1M8HZQd+4IUZVkKYwp0Xcsv5i17tfZj7IulCxLLxQx3N9ecg5R3y/kz0k2ELNkgS+KzkOmG1zR1BUFJSUWhqqqDGvuqKPgzCaezFsF1KHOF2uTwtnt1LpchnuUWd7HBbVwi0jVHCoeicAni25XB1yuDLz8KfH+s0W8r9L29uHz9BkUAJfP8Q7/cAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"permissions\",\n    \"title\": \"permissions\",\n    \"src\": \"/static/15db64adbd6f452a1f518a715e60405d/c1c45/permissions.png\",\n    \"srcSet\": [\"/static/15db64adbd6f452a1f518a715e60405d/0e2fe/permissions.png 285w\", \"/static/15db64adbd6f452a1f518a715e60405d/432e7/permissions.png 570w\", \"/static/15db64adbd6f452a1f518a715e60405d/c1c45/permissions.png 824w\"],\n    \"sizes\": \"(max-width: 824px) 100vw, 824px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"permissions\"), \"\\n  \")), mdx(\"h3\", {\n    \"id\": \"create-connection-from-the-bot\"\n  }, \"Create Connection from the Bot\"), mdx(\"p\", null, \"Got to your \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Bot Channels Registration\"), \", into settings and under \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"OAuth Connection Settings\"), \" press \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Add setting\"), \". Fill in a new name, I\\u2019m using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Azure AD V2\"), \", the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"appId\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"secret\"), \", and the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"tenantId\"), \". The scopes are case sensitive and separated by one single space. \"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"375px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"156.140350877193%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAfCAYAAADnTu3OAAAACXBIWXMAABJ0AAASdAHeZh94AAADjklEQVRIx6VWaZPaOBDl//+kfJ3abDKZrdqB2cBgwIDvCx/YkmzZflvdxoY5ks1mVPVKh+VW99NTS7OqqrBYLLBer/H4+IjlconNZgPDMPD8/Mz91WqFPM9BpW1bdF3HNZWiKBBFEcgO1TMpJR4e/sIfnz/j7u4O8/kc88UC9/ff8OXLn3h6esL9/VdYloW+7/G6KKVwPp/RNA3Xs7bVqEUJIQR/zIsCtRQMWpUghMQpjiBFyUbI8IixjO1ZqTQWvkQlFWql6BO8okFS1myUjHWtRlH3SMoGSlQQUkIKAYqOHKFFRypmqWjxySjhRye4joNO13gKamyjCqHv4ni00CiBQ6rh5g2SKEAcx8yX7/sIggCe50FrPXjYMblk/YbsntChu4TFY90w3nU9zxvR38whzF6TfMvP/wFGDlutOYQsSycp/G4hwzNym4wRqqqEIsKlmEAb9SsgtbCHfd8hiUM4tgXbOsJ3Hbi2Bcc6wnVsZOkJRZ79FHmWQik5GCSZkKsDwd0LTroL0b8C+n/gsG2R5xmrnEBH6VwUSNP03ZPx3xy2LfOXs/s5I0tTpKfkymGtprqpa9RvoKYNnZHVKAyYr8B34XsOt8PAZy4JnuvA99x3+ST+aA8mDq9h9QwSOKm+HdHqa5/50m+h9ZVDrRscDgcEQQjX83BOTh/ToahbPBgeHrcuFmaArV/AyhqYUYV9InBIJIPa3D/J61gsGJuwRFhedJirHl+NAN8NEyvTwdK0YboRjIOHrR3g7+UWy52FxXqP79sjNlaA+fOO8c/mwFgdfKzj5hJy1yOsesTiBrJHcNa8anBuuD3UA/xiGPOLGkEx9AvVXnVIpyOOQt7FOAqQxRGgm9/jkFK3ZdlTbnMcB1EYQlZDBpdKQan3tHeFqmu+AoZ82HV8KqIo5KQ5Jk8yPibPLMtYMvQTqeIlNI9T5p50SIMj6COldsWeDeCTUv/cyyljkwEKN0kShGGI9PRBHZJl27Jg2zaHR6FTKK+9lJdb8XacPB/7+pZD4opOy36/h2ma2O9NbLdb7E2TL326k3e7HS9qGOvLQ2DNcwhjUn7BIRmmesgq9ZusQtS8x11z+TZxSA3ij3a3LMuP3ylknbRHoZJcRnn8CLdqeD0+3SlxHDE/zgXE4fF45IUIxBNxPPaJa5pj7nY8n4xNOiTuKFQCPysu9fjMGEHPDdppmjfO4TEpJ47J4L8RmFlhitzLKgAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"connection\",\n    \"title\": \"connection\",\n    \"src\": \"/static/2ed6b584465db510db4b02da49395810/5ff7e/connection.png\",\n    \"srcSet\": [\"/static/2ed6b584465db510db4b02da49395810/0e2fe/connection.png 285w\", \"/static/2ed6b584465db510db4b02da49395810/5ff7e/connection.png 375w\"],\n    \"sizes\": \"(max-width: 375px) 100vw, 375px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"connection\"), \"\\n  \")), mdx(\"p\", null, \"And after saving, you could click on the connection and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"test connection\"), \" as well. First, you need to consent and then you could get a token.\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"438px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"122.45614035087719%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAA7DAAAOwwHHb6hkAAACpElEQVQ4y61VyY7TQBDNj3GECxckhLjzO3AACYnlxq9wIpokJDhDQiZeYmdiZ/MaJ/GWh17NeMYzWUQkLJWru11+/V5VtV3Df75qvK3cCBff38IwW5hcz2DbE1imiaIosNvtzrIasIOfAKpziW1kIwhjhEGAMAyPsuCLRxnKoyJHHK2xWHqYz2fwPE9suVxiPp9jsVhgNpuJ933/DvAQsEjO8hxBEGC9XmO1WonfbDZ3liQJttutjOmZipOABOh0OlCULrrdG+PcMAxcXV2hXq+j1Wqh0Wig2WwijuPTgEWRw3cXmE8dRGEA27YxnU5FIjcrGadpKmyrkh/LF8B4m6HRM9H+Y6KnTTC5vobjOBiPxwJ0qChVq64LYJrvYHoFnAgIkvN7rwp6A5gkMLQhDF1F7/cler0eBoMBTNOEpmkyVhRFcsucct7v9yWOz6usBTCXKodwPQ+u60lrsG1YeVa9rPzj6rM4zOkeINvAdV3pOU9AXSkIC0OQsyUTMMsyYUQw7sxx2dxkzA04/mdAtgRfJCsCEaD03KRkzhhuVqalVLCXQ+aJzKIoEs+zzDXOaXyRvjxRNMaRyB4gFymHIMxjKZfnt2TEOZ9x7VBvPujDUjKNuaSRddWnableILuNpfFs0z84KQy0LAvD4VD6Std1GY9GIzFdU2GZI4x0DaY5gqqq0qM868wrle0BMohADCQINxBwTYNqWNAsG319DHPiwA8CZFmONMsqcuV+L7ls4uD248ox/TqOsU4LxBngbwpsst3Jfqyd+vpyIzLvKr/QajZwqXQwHKp4+bmJJ+/qePXlJ56+v8CzDxdwgu295EP/hrL6zGW73caPH3Xxg6GK119bAvLmm4IXn1p4/rGBaVgBPPe/cVLyKbBjf7biyJwM/wKOFzV/mje4BAAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"consent\",\n    \"title\": \"consent\",\n    \"src\": \"/static/d1734083a8a221718ccc2d624695f001/50e4b/consent.png\",\n    \"srcSet\": [\"/static/d1734083a8a221718ccc2d624695f001/0e2fe/consent.png 285w\", \"/static/d1734083a8a221718ccc2d624695f001/50e4b/consent.png 438w\"],\n    \"sizes\": \"(max-width: 438px) 100vw, 438px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"consent\"), \"\\n  \")), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"439px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"37.54385964912281%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABQ0lEQVQoz61Q2W6DMBDk/78piio1iiFpMWBjk9BKDU95qMFcOSFTeRFSpPaxlkZ7eHd2dj3GGMIoxmbL4AcB1r6PMAqRphIiTrBcvmC1ekUQBHjbbsDYBmu2hhSC4pBz+D7DYrFAEsfwmqZB07ZomhqVtbDWUtz3HYwxOB6PlKvreqqpppq+7+F6q6qCtRXVtm0LL9/nGIYB//W8sixpglNgHchvUNeWbNt1pMjVGfNNvlPilFXUa1GaEpfLZSJMUwWVptCZhtIKUkp8FQWyTCLb5dh95BBSgPN3RBFHkkjk+SeETCGTGNl+D84jGkCE1+sVt9uNcL/faf1xGMi6eM7Pf+49Ho9fq47jOBEWXwcIIaGUwuFQ0LFPpxO6rkNpDJTW0FrTmg4zmbPP/my98/mMZ7hbOCVzPA9wvttmJvoLTuEPchJb8vzLhjUAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"test\",\n    \"title\": \"test\",\n    \"src\": \"/static/abc1441247461443c4bf86b004b08d24/e3b18/test.png\",\n    \"srcSet\": [\"/static/abc1441247461443c4bf86b004b08d24/0e2fe/test.png 285w\", \"/static/abc1441247461443c4bf86b004b08d24/e3b18/test.png 439w\"],\n    \"sizes\": \"(max-width: 439px) 100vw, 439px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"test\"), \"\\n  \")), mdx(\"h3\", {\n    \"id\": \"add-connection-to-env\"\n  }, \"Add connection to .env\"), mdx(\"p\", null, \"We add the name of the connection we just created into the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".env\"), \" file. For production scenarios, we have to also add the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"connectionName\"), \" to the Azure App Service application settings.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"MicrosoftAppId=<idToFirstAADregistration>\\nMicrosoftAppPassword=<secretToFirstAADregistration>\\nconnectionName=GraphConnection\\n\")), mdx(\"h1\", {\n    \"id\": \"project-changes\"\n  }, \"Project changes\"), mdx(\"p\", null, \"This is a high-level visualization of how the Bot is built:\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"860px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"85.96491228070175%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABJ0AAASdAHeZh94AAAEP0lEQVQ4y42S608TZhTG+R+2ZEuMEXSTGTcVmnQIE6fsFoxb4t0t28zMNuc20ZUijosdyhAFKpaWQkFFNGbLooIy0QwU20KhhdJ7QWOcblxKoaU3KLT9LaCOb8tO8uS8n37nOed54wBC4Qh1LY8o//U+ZRedVP8ygOq3QU5fclLS4KC66SEuT5h2g5uyRieSWiuyy04qLzkoPmtHrLRy8vIgU+EIcXPAB0987DvVh6TGQsJBNRnSfjZVGhEUG1ie08m6/R2oTaMcVOkRHO9l5WEt753Q8355L6n5XaR82U7692qGx6eIIzrDX3cNfFioI7PMiEBhRaCyIaix8lbjAGuUNt4puEeb2cD2020kKBwkym2slpkRnBsgucpKWl4XmXkaRueBoQAug53kIz3ESy2kKqzEFxt4tdSIUGbmdZmNtSVqWm4a2VRkJLGil9R6CwkSPYtPWRAq7SyqcpJR0syE108cwQDBwYcoWx6TJzchqjRyRGEmV24mR9bPD1IjRfVOHg14adYOk63oJa/hD3JVBnJVPfxY141Y3se52/3EmHM4FeDPbjsFFx+wp7SXt7M17C3t4dsKA7uOdbNBrCUzt5O7HU9ovP0YUZWJ7Xk3OXymnezTbewsbGVzwQ2yqtsJR+ZvOMuIzsQnOxtYcaSDV1T3SauxklprJ11lZ5HcQfrBe9y69Yjdkm6SxZ28JnXwZrkFodTG8lITHxRe56PC67gmfU9TDkxFqL7ygNw6GweqzWQrTIiq+hErTHwnN3Os0cnD4SAfH+0mSaRhmcJKusqKsNZGgrSPDHEbWyStuH3PgH+Phcivt/PFiV525WnZW9nHZ1Um9siMfF2iY2t+F3qnl0+L9CSJtbxYc5+V9QMsqx/kZZmdtKwutkhuMvYcODoxTcYhNRsPqXn30D3WVBhJaRwkWWkis6iJbUXXuW0283lRD4kFOlbVOUiZP4uVFTV2knJ0bDv6+wLQ5ZlmQ5aatfs7SP3mDgnFBlYp7SytMJJ2uJnN+c20mnv4StrKxqPXiD9jRaC0sabGzrJTRtYf0Mw7/HflSDTGHeMYTZohbnQOc6VnhCbDCFcNo1zVDNFhHGPIHWZnQTdCkYbFMhtChYVV1Vbiy0ysz9IuAGOxGP+n3JPT7CjQIRSpWSK3sbbegaDeSXy5ifQD2oVQ5oBzmnMZiUSfau4dfdpnZ6PzwFHPNDvydaTkaFlS6yTprJM3zg2wVGYhQ6Rm608tC9/mv+q5/+B0hN0SPSv23eWFn02sLusnsdzCS8f0rBNdY/vxVryBMHFTgRl8Hj+hUJBQ8JlCIQJ+P8FQiKjPR9g9Tiw2i6Z/iBMNFqQXrZy8YObkeRMVjRaKz9u4YxiZHxw3E47gHZ3A5/UwMT7OpNuN3+fDOzbGhMtFxOcj5HIx7nIxPTlBNDAOM36iM35iQQ9MeYn4x5gJeJiL4x+CcheUtOd50gAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"diagram\",\n    \"title\": \"diagram\",\n    \"src\": \"/static/667132a5fa2017d4cf3292ca7fa65795/914ae/botdiagram.png\",\n    \"srcSet\": [\"/static/667132a5fa2017d4cf3292ca7fa65795/0e2fe/botdiagram.png 285w\", \"/static/667132a5fa2017d4cf3292ca7fa65795/432e7/botdiagram.png 570w\", \"/static/667132a5fa2017d4cf3292ca7fa65795/914ae/botdiagram.png 860w\"],\n    \"sizes\": \"(max-width: 860px) 100vw, 860px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"diagram\"), \"\\n  \")), mdx(\"h2\", {\n    \"id\": \"botts\"\n  }, \"bot.ts\"), mdx(\"p\", null, \"Since we want to use the Bot in Microsoft Teams later, we will change so the Bot no longer derived from \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ActivityHandler\"), \", instead \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"TeamsActivityHandler\"), \".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"export class SimonBot extends TeamsActivityHandler {\\n\")), mdx(\"p\", null, \"We also add two more methods\"), mdx(\"h3\", {\n    \"id\": \"ontokenresponseevent\"\n  }, \"onTokenResponseEvent\"), mdx(\"p\", null, \"In non-Teams situations, we need to implement the onTokenResponseEvent to make sure the dialog is run with the new token response event.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"this.onTokenResponseEvent(async (context, next) => {\\n      console.log('Running dialog with Token Response Event Activity.');\\n\\n      // Run the Dialog with the new Token Response Event Activity.\\n      await (this.dialog as MainDialog).run(context, this.dialogState);\\n\\n      // By calling next() you ensure that the next BotHandler is run.\\n      await next();\\n  });\\n  }\\n\")), mdx(\"h3\", {\n    \"id\": \"handleteamssigninverifystate\"\n  }, \"handleTeamsSigninVerifyState\"), mdx(\"p\", null, \"And in Teams situations, we need to implement handleTeamsSigninVerifyState, because Teams handles it a bit differently. \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"protected async handleTeamsSigninVerifyState(context: TurnContext, query: SigninStateVerificationQuery): Promise<void> {\\n    await (this.dialog as MainDialog).run(context, this.dialogState);\\n  }\\n\")), mdx(\"h2\", {\n    \"id\": \"maindialog\"\n  }, \"mainDialog\"), mdx(\"p\", null, \"In the main dialog, we import the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"OAuthPrompt\"), \", add a new constant\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"const OAUTH_PROMPT = 'OAuthPrompt';\\n\")), mdx(\"p\", null, \"And then add \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"promptStep\"), \" and the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"OAuthPrompt\"), \" using the connection.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"this.addDialog(new SiteDialog(SITE_DIALOG))\\n        .addDialog(new WaterfallDialog(MAIN_WATERFALL_DIALOG, [\\n            this.promptStep.bind(this),\\n            this.initialStep.bind(this),\\n            this.finalStep.bind(this)\\n        ]))\\n        .addDialog(new OAuthPrompt(OAUTH_PROMPT, {\\n            connectionName: process.env.connectionName,\\n            text: 'Please Sign In',\\n            timeout: 300000,\\n            title: 'Sign In'\\n        }));\\n\")), mdx(\"h3\", {\n    \"id\": \"promptstep\"\n  }, \"promptStep\"), mdx(\"p\", null, \"The prompt step only kicks off the new login prompt.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"private async promptStep(stepContext: WaterfallStepContext): Promise<DialogTurnResult> {\\n    return await stepContext.beginDialog(OAUTH_PROMPT);\\n}\\n\")), mdx(\"h3\", {\n    \"id\": \"initialstep\"\n  }, \"initialStep\"), mdx(\"p\", null, \"The initial step is changed. It will now get the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"token\"), \" from the previous step in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"stepcontext.result\"), \". \"), mdx(\"p\", null, \"An important thing to notice is that we don\\u2019t save the token. The idea is to call the prompt again when we need the token. If the user is still logged in it will just send back a token. Otherwise, the user will have to log in again - so there\\u2019s no need to save the token locally since we could end up with expired tokens.\"), mdx(\"p\", null, \"If we didn\\u2019t get a token, the login wasn\\u2019t successful.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"private async initialStep(stepContext: WaterfallStepContext): Promise<DialogTurnResult> {\\n    const tokenResponse = stepContext.result;\\n    if (tokenResponse) {\\n        await stepContext.context.sendActivity('You are now logged in.');\\n        \\n        const siteDetails = new SiteDetails();\\n        return await stepContext.beginDialog('siteDialog', siteDetails);\\n    }\\n    await stepContext.context.sendActivity('Login was not successful please try again.');\\n    return await stepContext.endDialog();  \\n}\\n\")), mdx(\"h1\", {\n    \"id\": \"adding-the-possibility-to-log-out\"\n  }, \"Adding the possibility to log out\"), mdx(\"p\", null, \"We add another case \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"logout\"), \" to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HelperDialog\"), \" that we added in part 4 (interruptions).\\nUsing the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"signOutUser()\"), \" method in the BotFrameworkAdapter to sign out the user, and then cancel all the dialogs.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"private async interruption(dc: DialogContext): Promise<DialogTurnResult|undefined> {\\n    if (dc.context.activity.text) {\\n        const text = dc.context.activity.text.toLowerCase();\\n\\n        switch (text) {\\n            case 'help':\\n            case '?':\\n                const helpMessageText = 'Answer the questions asked. If you want to restart use: cancel, quit or restart';\\n                await dc.context.sendActivity(helpMessageText, helpMessageText, InputHints.ExpectingInput);\\n                return { status: DialogTurnStatus.waiting };\\n            case 'cancel':\\n            case 'quit':\\n            case 'restart':\\n                const cancelMessageText = 'Restarting...';\\n                await dc.context.sendActivity(cancelMessageText, cancelMessageText, InputHints.IgnoringInput);\\n                return await dc.cancelAllDialogs();\\n            case 'logout':\\n                const adapter: any = dc.context.adapter;\\n                await adapter.signOutUser(dc.context, this._connectionName);\\n                const logoutMessageText = 'You have been signed out';\\n                await dc.context.sendActivity(logoutMessageText, logoutMessageText, InputHints.IgnoringInput);\\n                return await dc.cancelAllDialogs();\\n        }\\n    }\\n}\\n\")), mdx(\"h1\", {\n    \"id\": \"test-login\"\n  }, \"Test login\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Run the local Bot by using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"npm start\"))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Start the emulator and check the settings at first. \"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"I had some issues getting the login to work. Your best bet is to download the latest emulator, and these are the settings that work well for me:\"))), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1030px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"33.68421052631579%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABJ0AAASdAHeZh94AAABDElEQVQoz41RW07EMAzM2RGnQHzABxdA/HEahLSbpO2Sdxqn7SB71WoREsLSKI7ijD1j1XvHf2NdV3A9EWHbth9vfGeomDI6kRT+BfmwdpScEGPEPM9CzFiW5SBVH9ZhHAZYa2AMw8JaK7nWRvKcM5dDTw16iKglI4QI5xxCCEgpodYqpGoMBbVeu7XWQNTQqaE1npokZ6kcLhK+fEYpGTkXacRgQibm/+rzpHEeJpjJ4eI9Xt5H3D2d8fBqcf98xuPbePjEDWotIvEW3HCH0uNVQkpZvLFTwiUs8Klj8h0u9mMB89ykhqfik2Xu0++hTsYjRS+eiB/Rg1r5tUEOtoV9Y4neezlvN8xL+QZqXR5X1lKy9wAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"emusettings\",\n    \"title\": \"emusettings\",\n    \"src\": \"/static/b0d4cdfbda47deb288cd9401abb3e4b5/7a1fb/emulatorsettings.png\",\n    \"srcSet\": [\"/static/b0d4cdfbda47deb288cd9401abb3e4b5/0e2fe/emulatorsettings.png 285w\", \"/static/b0d4cdfbda47deb288cd9401abb3e4b5/432e7/emulatorsettings.png 570w\", \"/static/b0d4cdfbda47deb288cd9401abb3e4b5/7a1fb/emulatorsettings.png 1030w\"],\n    \"sizes\": \"(max-width: 1030px) 100vw, 1030px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"emusettings\"), \"\\n  \")), mdx(\"ol\", {\n    \"start\": 3\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Then connect to the Bot from the emulator using http://localhost:3978/api/messages and the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"appId\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"secret\"), \".\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Write something to kick off the dialogs. And the press login, and open the window.\"))), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"593px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"91.57894736842105%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABJ0AAASdAHeZh94AAAB9UlEQVQ4y42Uy47TQBBF/ats+A42sOAfWLBlNV8AQjNLNCOxyDs28SQh8fud2LF90a2kQh4OpKWj6m53XVdXV7eBQ2vbVmxd16iqCrvdTtD+6VxZljLuwrgU5GQURQiCAJ7nIQxD+L4vVufSNL1JpyCdl8sl5vM5XNfFYrEQ1uu12CzL7hfklhgJhYjjOGIpRjimY57nInwK5zoFGSEdCUVOhWn5nWmJ41iswnmDQooK0mk0GmE6nWI8HgvaHw6H8o39yWSCfr+PXq+HwWAg9hihNhU0TRO2bUsuLcvCbDYT+8uyYJpT+U5Wawd+EMLzAwRBBIMCLBWFJZEkyXmyk0S2F0Yx4jRDlCTwwwhFngJ1gboq0OwK6RssidVqdcwPx1fJzjIEaYEw22Js2bBef6Nuazw8OXjzYYr3n228+2Tj7UcTBiPg35Wr6A7ESSrRrRwXjhcgLwpM7BDfn128DHz86Pl4fPFgbLdbbDYb2areFPZvIbelqkC/tqmYdVbvgd35oehJ39t0+ZdvAb4+J9I/KxsVvJzrRgNo8PDo4elnvBe8/mt7N03TYJ+yQq6sCPK66GEQ5lPz+j+4TmFuRZAnePqa6AHpwrLcno27oM8xQlW+1bJNgzCt0fzjvLj1o+A+ir9lcflgFptSKMvq5qOqfhT8A0m+atdCMGFsAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"openurl\",\n    \"title\": \"openurl\",\n    \"src\": \"/static/54363c6184835280c1b344e5e4877c01/0b5b1/openurl.png\",\n    \"srcSet\": [\"/static/54363c6184835280c1b344e5e4877c01/0e2fe/openurl.png 285w\", \"/static/54363c6184835280c1b344e5e4877c01/432e7/openurl.png 570w\", \"/static/54363c6184835280c1b344e5e4877c01/0b5b1/openurl.png 593w\"],\n    \"sizes\": \"(max-width: 593px) 100vw, 593px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"openurl\"), \"\\n  \")), mdx(\"p\", null, \"This opens a window where you can copy the verification code and message back to the Bot. Then you receive your token.\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"577px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"53.68421052631579%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABDElEQVQoz52Sb06EMBDFezpP4A32CPtVD+AB9tMewvsQCWKEZaPyb2lpKZ1npmxdTRYUJ/nxoB1epp0R1lo4577g72EY/gX/K6qqQhRFSJIEcRyjKAq0bYumabz+Fc5XSkF0XYe6rv0iq5QSxhhorWGM9irVBL9fg/P7vvcIfiyFHQlpYfDeWNBC3jg6KDbkMrkq1jmkVIv7wcNXyEdmuCFEtAp3VnDtZxWhu2vD0XQBh48B290LNg8Jdo9HiJCwujo3GT4fNG7vn3CzjXC3f70YXgsi+mWP/Ellb3F8a9CeFARfJs9QgEcnjE8wnDP+ue4AchBlWSLLMuR57uEBT9PUm34/4pzZJce3Bp9cFFdnM5v81wAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"loggedin\",\n    \"title\": \"loggedin\",\n    \"src\": \"/static/458b189670949072fbc1720452d9c933/065e2/loggedin.png\",\n    \"srcSet\": [\"/static/458b189670949072fbc1720452d9c933/0e2fe/loggedin.png 285w\", \"/static/458b189670949072fbc1720452d9c933/432e7/loggedin.png 570w\", \"/static/458b189670949072fbc1720452d9c933/065e2/loggedin.png 577w\"],\n    \"sizes\": \"(max-width: 577px) 100vw, 577px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"loggedin\"), \"\\n  \")), mdx(\"h2\", {\n    \"id\": \"login-in-teams\"\n  }, \"Login in Teams\"), mdx(\"p\", null, \"We need to make some changes to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"manifest\"), \" in App Studio for the login to work. Right now the window would not open.\"), mdx(\"p\", null, \"As we did in \", mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azurebot-nodejs-part2\",\n    target: \"_blank\"\n  }, \"Microsoft Teams (Part 2)\"), \", we will start App studio from Microsoft Teams and edit the manifest of our Teams App.\"), mdx(\"p\", null, \"Under \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"domain and permissions\"), \" we need to add \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"token.botframework.com\"), \" as a supported host, this will allow the popup to be opened.\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"487px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"84.91228070175438%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABJ0AAASdAHeZh94AAABu0lEQVQ4y5VU23KbMBTk/3+peU3fbB7bvOSCQYCEERI3CSFtRgc3dds02MzsnAuaZY9WIgEA5xymaYK1FtYuWJYFPnjqr+sKBCCEcBOSSPj08wceHr7hmKY4HlM8Pn5HejhQPBxS9P2AWx8iHMcRSin0fb9B9xiHAVr3GIYBxhgs1mKeDRbnaBLqLctlqq2OPETYqQ6iEWiaBlVVEWJ+bhrUVQVec5SsQFVzyLZFkefI3jJaI1tJa2rO8fr8vBEGH+C9J8nX+3Fd/3qu8/+OLITAy8srypKhKBhYUUBwjjoqK0sILsB5DS4EuOBgUe1lkviOsRKcCzScIblWFFVGtX/Unzj50feecr/6jx4pVLpHpzZDZKcgZQd9h7P/jBzPoJTthvY3tFLQWmEaR8zTiOkGbMdm6MGKHEV+Qn7KUOQZTtkb1bGvVYdeq5uQ7Ln2t/P7NyUm+5T37WFk7qRE257pxsj2jE5ptLSPGiHcaUr8AZh53mAMjLnEeYY1M7xfsToH55ZdEKG1BoLXqEoGXpUUKa8riLqmGI2zZoKZvwYRusWSQ/GIfO6opsXxw1HxV0hC2L+fF6tvcvkdxocpeOOJYOEAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"validdomains\",\n    \"title\": \"validdomains\",\n    \"src\": \"/static/6b3bce64b190f73f1c9df645ff660e43/7b439/validdomains.png\",\n    \"srcSet\": [\"/static/6b3bce64b190f73f1c9df645ff660e43/0e2fe/validdomains.png 285w\", \"/static/6b3bce64b190f73f1c9df645ff660e43/7b439/validdomains.png 487w\"],\n    \"sizes\": \"(max-width: 487px) 100vw, 487px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"validdomains\"), \"\\n  \")), mdx(\"p\", null, \"Spin up \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ngrok\"), \" again \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"ngrok http 3978 \\u2014host-header=localhost\")), mdx(\"p\", null, \"Then we could go to Azure once again and change the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"messaging endpoint\"), \" in the Bot Channels Registration to point to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"https://<ngrokUrl>/api/messages\")), mdx(\"p\", null, \"Now if you write something to the Bot in Teams, you get a similar login experience\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"901px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"23.157894736842106%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABJ0AAASdAHeZh94AAAAsUlEQVQY032P7Q6DIAxFff/H3MyMUFSkIEjxLug+4kx2k8Nt+XGSNq0ihMAYxxEhBDDz3jXbtn3IOZ8QEaQUMdsJbrYfmt70WHOCUgpa9ei6B7z3F+EvNeuarkKeLYoIiBzalmCtRykF/3IWjrv0TVMfkYwQMqxdsCwrYoz7SSIFRcprvpJiBDsHZne0c4ewDsEz4uIxTQPa+w2aNAxpEBGGwexNr71iBgOtNUh//8gQnsjMg3aHekFjAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"signinteams\",\n    \"title\": \"signinteams\",\n    \"src\": \"/static/a44aca5b39ee4387c972c4d9360cb126/0955e/signinteams.png\",\n    \"srcSet\": [\"/static/a44aca5b39ee4387c972c4d9360cb126/0e2fe/signinteams.png 285w\", \"/static/a44aca5b39ee4387c972c4d9360cb126/432e7/signinteams.png 570w\", \"/static/a44aca5b39ee4387c972c4d9360cb126/0955e/signinteams.png 901w\"],\n    \"sizes\": \"(max-width: 901px) 100vw, 901px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"signinteams\"), \"\\n  \")), mdx(\"p\", null, \"If you press Sign In Teams will open a window briefly, and then close it to get you the token.\"), mdx(\"p\", null, \"And we are logged in\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"682px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"35.08771929824561%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABJ0AAASdAHeZh94AAAAvElEQVQoz5WQ3Q6CMAyF9/6v6AUJJCr+ja0tZZ1wzBDUGyOe5Esvup6e1VHswDFCmMFEoBggwmAm9MIYVDFovxl3vnbY7Q9QFcRiLIKcM8xspmiapk0UuRACTtcjck64nC9o6hpNU6OqKpTeP4bjOMKtX872TOV9BJFA+Jl0i+HnGxdDQAwdshlK73brQZSwah3YosWwQ0lplpbhd/zCfb5nWm6avmCvuhgGqCq89y/atp1vOAyKdWmpv3gAJSEiWYD9P2YAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"loggedinteams\",\n    \"title\": \"loggedinteams\",\n    \"src\": \"/static/147d28ae3aa98ff7dc529b4926440730/160a3/teamsloggedin.png\",\n    \"srcSet\": [\"/static/147d28ae3aa98ff7dc529b4926440730/0e2fe/teamsloggedin.png 285w\", \"/static/147d28ae3aa98ff7dc529b4926440730/432e7/teamsloggedin.png 570w\", \"/static/147d28ae3aa98ff7dc529b4926440730/160a3/teamsloggedin.png 682w\"],\n    \"sizes\": \"(max-width: 682px) 100vw, 682px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"loggedinteams\"), \"\\n  \")), mdx(\"h1\", {\n    \"id\": \"next-step\"\n  }, \"Next step\"), mdx(\"p\", null, \"In the next post, we will add some helpers and enable the user to utilize the Microsoft Graph. We will create an example using both the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Microsoft Graph Client\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"PnPjs Graph\"), \" for hooking into the Azure Bot Service auth-flow.\"));\n}\n;\nMDXContent.isMDXComponent = true;","keywords":null,"tags":[{"id":"4a3b863b-2ddd-5eae-8e53-b85dea2ea045","name":"botframework","slug":"/tag/botframework/"},{"id":"ebfba2f8-5479-5edb-b0af-a656cd15bfa4","name":"teams","slug":"/tag/teams/"},{"id":"3854a95d-b2b2-52b0-a0d7-8e558721d1e6","name":"msgraph","slug":"/tag/msgraph/"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/d069abc39a202859cea11fc120ae11c0/19188/botframework5.png","srcSet":"/static/d069abc39a202859cea11fc120ae11c0/db297/botframework5.png 190w,\n/static/d069abc39a202859cea11fc120ae11c0/19188/botframework5.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/d069abc39a202859cea11fc120ae11c0/228d6/botframework5.webp 190w,\n/static/d069abc39a202859cea11fc120ae11c0/6b99c/botframework5.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/d069abc39a202859cea11fc120ae11c0/5fb32/botframework5.png","srcSet":"/static/d069abc39a202859cea11fc120ae11c0/739fd/botframework5.png 600w,\n/static/d069abc39a202859cea11fc120ae11c0/5fb32/botframework5.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/d069abc39a202859cea11fc120ae11c0/288e3/botframework5.webp 600w,\n/static/d069abc39a202859cea11fc120ae11c0/5b893/botframework5.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},"tagCategoryPosts":{"nodes":[{"id":"95bc278d-e498-54ab-9a09-4392f627a596","title":"Bot Framework in Node.js - Proactive messages and token validation","slug":"/azurebot-nodejs-part8/","link":null,"excerpt":"In the last post we got a little fancy using Adaptive cards in the Bot. We talked about workarounds…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 10, 2021","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/0011cc7c64bf6a7a48e29df018eb1adf/19188/botframework8.png","srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/db297/botframework8.png 190w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/19188/botframework8.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/228d6/botframework8.webp 190w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/6b99c/botframework8.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/0011cc7c64bf6a7a48e29df018eb1adf/5fb32/botframework8.png","srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/739fd/botframework8.png 600w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/5fb32/botframework8.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/288e3/botframework8.webp 600w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/5b893/botframework8.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"47fa3c51-0e3f-5954-bc51-298d260844de","title":"Bot Framework in Node.js - Adaptive Cards (part 7)","slug":"/azurebot-nodejs-part7/","link":null,"excerpt":"In the previous post, we added some helpers and enabled the user to call Microsoft Graph. We used…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 08, 2021","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/b8577e12e0c806356bde4bd7135e8bcf/19188/botframework7.png","srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/db297/botframework7.png 190w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/19188/botframework7.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/228d6/botframework7.webp 190w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/6b99c/botframework7.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/b8577e12e0c806356bde4bd7135e8bcf/5fb32/botframework7.png","srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/739fd/botframework7.png 600w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/5fb32/botframework7.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/288e3/botframework7.webp 600w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/5b893/botframework7.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"f22060a9-6d2c-5f4c-afb8-98a59bdcc540","title":"Microsoft Graph Presence API - top of mind scenarios","slug":"/graph-presence/","link":null,"excerpt":"The new presence API in Microsoft Graph is very popular. We've seen a lot of blog post where people…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 06, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/9349ac165f3b22a5d70d0a19c66bd235/19188/presence.png","srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/db297/presence.png 190w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/19188/presence.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/228d6/presence.webp 190w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/6b99c/presence.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/9349ac165f3b22a5d70d0a19c66bd235/945a8/presence.png","srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/17e9b/presence.png 800w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/945a8/presence.png 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"},"sources":[{"srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/c9f06/presence.webp 800w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/f47df/presence.webp 1600w","type":"image/webp","sizes":"(min-width: 1600px) 1600px, 100vw"}]},"width":1600,"height":650}}},{"id":"0ed2d4e8-d282-5d9c-b490-c2ce1b500a61","title":"Bot Framework in Node.js - Calling Microsoft Graph (part 6)","slug":"/azurebot-nodejs-part6/","link":null,"excerpt":"I the previous post, we created a new Azure AD Application registration, gave it permissions to…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"March 22, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/fb02b1615213cb512da7d1c78b9ad995/19188/botframework6.png","srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/db297/botframework6.png 190w,\n/static/fb02b1615213cb512da7d1c78b9ad995/19188/botframework6.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/228d6/botframework6.webp 190w,\n/static/fb02b1615213cb512da7d1c78b9ad995/6b99c/botframework6.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/fb02b1615213cb512da7d1c78b9ad995/5fb32/botframework6.png","srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/739fd/botframework6.png 600w,\n/static/fb02b1615213cb512da7d1c78b9ad995/5fb32/botframework6.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/288e3/botframework6.webp 600w,\n/static/fb02b1615213cb512da7d1c78b9ad995/5b893/botframework6.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"084e9867-ec33-5a14-9e1f-d91f4280dac2","title":"Azure AD & Microsoft Graph OAuth Connection, with Azure CLI","slug":"/azcli-connection/","link":null,"excerpt":"In the previous post  Azure AD & Microsoft Graph permission scopes, with Azure CLI , we registered…","timeToRead":1,"featured":null,"thumbnailText":null,"date":"March 11, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/fba499085724398a27f00be5af554b7e/19188/azcli-connection.png","srcSet":"/static/fba499085724398a27f00be5af554b7e/db297/azcli-connection.png 190w,\n/static/fba499085724398a27f00be5af554b7e/19188/azcli-connection.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/fba499085724398a27f00be5af554b7e/228d6/azcli-connection.webp 190w,\n/static/fba499085724398a27f00be5af554b7e/6b99c/azcli-connection.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/fba499085724398a27f00be5af554b7e/5fb32/azcli-connection.png","srcSet":"/static/fba499085724398a27f00be5af554b7e/739fd/azcli-connection.png 600w,\n/static/fba499085724398a27f00be5af554b7e/5fb32/azcli-connection.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/fba499085724398a27f00be5af554b7e/288e3/azcli-connection.webp 600w,\n/static/fba499085724398a27f00be5af554b7e/5b893/azcli-connection.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"d45b509b-06e7-5f59-9963-ab5041c1c9ec","title":"Azure AD & Microsoft Graph permission scopes, with Azure CLI","slug":"/azcli-adscope/","link":null,"excerpt":"In this small post, we will look at a scenario where we want to register an Azure AD Application…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"March 09, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/e5aceb9744ad9f189605a624aef5497e/19188/azcli-scopes.png","srcSet":"/static/e5aceb9744ad9f189605a624aef5497e/db297/azcli-scopes.png 190w,\n/static/e5aceb9744ad9f189605a624aef5497e/19188/azcli-scopes.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/e5aceb9744ad9f189605a624aef5497e/228d6/azcli-scopes.webp 190w,\n/static/e5aceb9744ad9f189605a624aef5497e/6b99c/azcli-scopes.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/e5aceb9744ad9f189605a624aef5497e/5fb32/azcli-scopes.png","srcSet":"/static/e5aceb9744ad9f189605a624aef5497e/739fd/azcli-scopes.png 600w,\n/static/e5aceb9744ad9f189605a624aef5497e/5fb32/azcli-scopes.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/e5aceb9744ad9f189605a624aef5497e/288e3/azcli-scopes.webp 600w,\n/static/e5aceb9744ad9f189605a624aef5497e/5b893/azcli-scopes.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}}]},"tagPosts":{"nodes":[{"id":"3775249d-bf27-553b-88e8-4f4354b2e1f5","title":"Custom Azure AD registration with Microsoft Graph PS","slug":"/custom-azure-ad-registration-with-microsoft-graph-ps/","link":null,"excerpt":"Introduction Similar to my post  PnP PowerShell - MFA account and Client Id  from a while back, I…","timeToRead":2,"featured":false,"thumbnailText":null,"date":"January 02, 2023","category":{"id":"b0babac0-675d-51af-aa7a-ce603b3a7af4","name":"Microsoft 365","slug":"/category/microsoft-365/","color":"#f25022","icon":"/static/363fdd53d34303b727d9dab161b8e88b/microsoft365.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/277677938ffc6d236164bf3a4fef9f3c/6b99c/image.webp","srcSet":"/static/277677938ffc6d236164bf3a4fef9f3c/228d6/image.webp 190w,\n/static/277677938ffc6d236164bf3a4fef9f3c/6b99c/image.webp 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/277677938ffc6d236164bf3a4fef9f3c/c9f06/image.webp","srcSet":"/static/277677938ffc6d236164bf3a4fef9f3c/6a2da/image.webp 400w,\n/static/277677938ffc6d236164bf3a4fef9f3c/c9f06/image.webp 800w","sizes":"(min-width: 800px) 800px, 100vw"},"sources":[]},"width":1600,"height":650}}},{"id":"47183d1a-665a-5630-b1f5-1120d6e50f33","title":"Microsoft Teams structure","slug":"/microsoft-teams-structure/","link":null,"excerpt":"Earlier, we have discussed why a governance strategy is essential, what usually happens without one…","timeToRead":3,"featured":true,"thumbnailText":null,"date":"December 13, 2021","category":{"id":"b0babac0-675d-51af-aa7a-ce603b3a7af4","name":"Microsoft 365","slug":"/category/microsoft-365/","color":"#f25022","icon":"/static/363fdd53d34303b727d9dab161b8e88b/microsoft365.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/static/8f7bf0d2a798e4f97970a3b1d257c007/19188/image.png","srcSet":"/static/8f7bf0d2a798e4f97970a3b1d257c007/db297/image.png 190w,\n/static/8f7bf0d2a798e4f97970a3b1d257c007/19188/image.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/8f7bf0d2a798e4f97970a3b1d257c007/228d6/image.webp 190w,\n/static/8f7bf0d2a798e4f97970a3b1d257c007/6b99c/image.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/static/8f7bf0d2a798e4f97970a3b1d257c007/84e46/image.png","srcSet":"/static/8f7bf0d2a798e4f97970a3b1d257c007/dcb64/image.png 350w,\n/static/8f7bf0d2a798e4f97970a3b1d257c007/84e46/image.png 700w","sizes":"(min-width: 700px) 700px, 100vw"},"sources":[{"srcSet":"/static/8f7bf0d2a798e4f97970a3b1d257c007/14281/image.webp 350w,\n/static/8f7bf0d2a798e4f97970a3b1d257c007/aca1f/image.webp 700w","type":"image/webp","sizes":"(min-width: 700px) 700px, 100vw"}]},"width":1600,"height":649.1428571428572}}},{"id":"77167810-7af1-5dc0-a1dd-a11b4a6d0e57","title":"Microsoft Teams settings and policies quick overview","slug":"/microsoft-teams-settings-and-policies-quick-overview/","link":null,"excerpt":"I introduced some governance options and high-level thoughts regarding them. In this post, I want to…","timeToRead":3,"featured":true,"thumbnailText":null,"date":"November 29, 2021","category":{"id":"b0babac0-675d-51af-aa7a-ce603b3a7af4","name":"Microsoft 365","slug":"/category/microsoft-365/","color":"#f25022","icon":"/static/363fdd53d34303b727d9dab161b8e88b/microsoft365.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/a1be53d5d8210ae59ab87eacf533a8cd/144fe/image.jpg","srcSet":"/static/a1be53d5d8210ae59ab87eacf533a8cd/9d7b9/image.jpg 190w,\n/static/a1be53d5d8210ae59ab87eacf533a8cd/144fe/image.jpg 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/a1be53d5d8210ae59ab87eacf533a8cd/228d6/image.webp 190w,\n/static/a1be53d5d8210ae59ab87eacf533a8cd/6b99c/image.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/a1be53d5d8210ae59ab87eacf533a8cd/5e493/image.jpg","srcSet":"/static/a1be53d5d8210ae59ab87eacf533a8cd/696c0/image.jpg 800w,\n/static/a1be53d5d8210ae59ab87eacf533a8cd/5e493/image.jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"},"sources":[{"srcSet":"/static/a1be53d5d8210ae59ab87eacf533a8cd/c9f06/image.webp 800w,\n/static/a1be53d5d8210ae59ab87eacf533a8cd/f47df/image.webp 1600w","type":"image/webp","sizes":"(min-width: 1600px) 1600px, 100vw"}]},"width":1600,"height":650}}},{"id":"d14c7057-fd15-5640-95d5-c157f55d2900","title":"Governance options overview for Microsoft 365 and Teams","slug":"/governance-options-overview-for-microsoft-365-and-teams/","link":null,"excerpt":"I introduced some high-level thoughts on a governance strategy and its importance in the previous…","timeToRead":4,"featured":true,"thumbnailText":null,"date":"November 15, 2021","category":{"id":"b0babac0-675d-51af-aa7a-ce603b3a7af4","name":"Microsoft 365","slug":"/category/microsoft-365/","color":"#f25022","icon":"/static/363fdd53d34303b727d9dab161b8e88b/microsoft365.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#484848","images":{"fallback":{"src":"/static/b7cd887809a8df737c6c319ac621d252/144fe/image.jpg","srcSet":"/static/b7cd887809a8df737c6c319ac621d252/9d7b9/image.jpg 190w,\n/static/b7cd887809a8df737c6c319ac621d252/144fe/image.jpg 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/b7cd887809a8df737c6c319ac621d252/228d6/image.webp 190w,\n/static/b7cd887809a8df737c6c319ac621d252/6b99c/image.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#484848","images":{"fallback":{"src":"/static/b7cd887809a8df737c6c319ac621d252/5e493/image.jpg","srcSet":"/static/b7cd887809a8df737c6c319ac621d252/696c0/image.jpg 800w,\n/static/b7cd887809a8df737c6c319ac621d252/5e493/image.jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"},"sources":[{"srcSet":"/static/b7cd887809a8df737c6c319ac621d252/c9f06/image.webp 800w,\n/static/b7cd887809a8df737c6c319ac621d252/f47df/image.webp 1600w","type":"image/webp","sizes":"(min-width: 1600px) 1600px, 100vw"}]},"width":1600,"height":650}}},{"id":"769a2ccd-fcfd-5c1c-93b5-190ec2dece54","title":"Why you need a governance strategy for Microsoft Teams and M365","slug":"/why-you-need-a-governance-strategy-for-microsoft-teams-and-m365/","link":null,"excerpt":"What is governance strategy? Simply put, governance strategy is about defining people, processes…","timeToRead":3,"featured":true,"thumbnailText":null,"date":"November 01, 2021","category":{"id":"b0babac0-675d-51af-aa7a-ce603b3a7af4","name":"Microsoft 365","slug":"/category/microsoft-365/","color":"#f25022","icon":"/static/363fdd53d34303b727d9dab161b8e88b/microsoft365.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#181818","images":{"fallback":{"src":"/static/d405897dbdc3f1a34e986c8f134dbf66/144fe/image.jpg","srcSet":"/static/d405897dbdc3f1a34e986c8f134dbf66/9d7b9/image.jpg 190w,\n/static/d405897dbdc3f1a34e986c8f134dbf66/144fe/image.jpg 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/d405897dbdc3f1a34e986c8f134dbf66/228d6/image.webp 190w,\n/static/d405897dbdc3f1a34e986c8f134dbf66/6b99c/image.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#181818","images":{"fallback":{"src":"/static/d405897dbdc3f1a34e986c8f134dbf66/5e493/image.jpg","srcSet":"/static/d405897dbdc3f1a34e986c8f134dbf66/696c0/image.jpg 800w,\n/static/d405897dbdc3f1a34e986c8f134dbf66/5e493/image.jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"},"sources":[{"srcSet":"/static/d405897dbdc3f1a34e986c8f134dbf66/c9f06/image.webp 800w,\n/static/d405897dbdc3f1a34e986c8f134dbf66/f47df/image.webp 1600w","type":"image/webp","sizes":"(min-width: 1600px) 1600px, 100vw"}]},"width":1600,"height":650}}},{"id":"49e2220d-3fd1-5575-b6c9-411f48106fbe","title":"PnP PowerShell - MFA account and Client Id","slug":"/pnp-powershell-mfa-account-and-client-id/","link":null,"excerpt":"The background of this post is that I got a question from a friend of mine. He was in a situation…","timeToRead":2,"featured":null,"thumbnailText":null,"date":"May 09, 2021","category":{"id":"b0babac0-675d-51af-aa7a-ce603b3a7af4","name":"Microsoft 365","slug":"/category/microsoft-365/","color":"#f25022","icon":"/static/363fdd53d34303b727d9dab161b8e88b/microsoft365.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#0878d8","images":{"fallback":{"src":"/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/19188/pnppsmfa.png","srcSet":"/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/db297/pnppsmfa.png 190w,\n/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/19188/pnppsmfa.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/228d6/pnppsmfa.webp 190w,\n/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/6b99c/pnppsmfa.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#0878d8","images":{"fallback":{"src":"/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/945a8/pnppsmfa.png","srcSet":"/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/17e9b/pnppsmfa.png 800w,\n/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/945a8/pnppsmfa.png 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"},"sources":[{"srcSet":"/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/c9f06/pnppsmfa.webp 800w,\n/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/f47df/pnppsmfa.webp 1600w","type":"image/webp","sizes":"(min-width: 1600px) 1600px, 100vw"}]},"width":1600,"height":650}}}]},"categoryPosts":{"nodes":[{"id":"95bc278d-e498-54ab-9a09-4392f627a596","title":"Bot Framework in Node.js - Proactive messages and token validation","slug":"/azurebot-nodejs-part8/","link":null,"excerpt":"In the last post we got a little fancy using Adaptive cards in the Bot. We talked about workarounds…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 10, 2021","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/0011cc7c64bf6a7a48e29df018eb1adf/19188/botframework8.png","srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/db297/botframework8.png 190w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/19188/botframework8.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/228d6/botframework8.webp 190w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/6b99c/botframework8.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/0011cc7c64bf6a7a48e29df018eb1adf/5fb32/botframework8.png","srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/739fd/botframework8.png 600w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/5fb32/botframework8.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/288e3/botframework8.webp 600w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/5b893/botframework8.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"47fa3c51-0e3f-5954-bc51-298d260844de","title":"Bot Framework in Node.js - Adaptive Cards (part 7)","slug":"/azurebot-nodejs-part7/","link":null,"excerpt":"In the previous post, we added some helpers and enabled the user to call Microsoft Graph. We used…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 08, 2021","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/b8577e12e0c806356bde4bd7135e8bcf/19188/botframework7.png","srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/db297/botframework7.png 190w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/19188/botframework7.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/228d6/botframework7.webp 190w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/6b99c/botframework7.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/b8577e12e0c806356bde4bd7135e8bcf/5fb32/botframework7.png","srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/739fd/botframework7.png 600w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/5fb32/botframework7.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/288e3/botframework7.webp 600w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/5b893/botframework7.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"f22060a9-6d2c-5f4c-afb8-98a59bdcc540","title":"Microsoft Graph Presence API - top of mind scenarios","slug":"/graph-presence/","link":null,"excerpt":"The new presence API in Microsoft Graph is very popular. We've seen a lot of blog post where people…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 06, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/9349ac165f3b22a5d70d0a19c66bd235/19188/presence.png","srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/db297/presence.png 190w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/19188/presence.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/228d6/presence.webp 190w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/6b99c/presence.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/9349ac165f3b22a5d70d0a19c66bd235/945a8/presence.png","srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/17e9b/presence.png 800w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/945a8/presence.png 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"},"sources":[{"srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/c9f06/presence.webp 800w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/f47df/presence.webp 1600w","type":"image/webp","sizes":"(min-width: 1600px) 1600px, 100vw"}]},"width":1600,"height":650}}},{"id":"0ed2d4e8-d282-5d9c-b490-c2ce1b500a61","title":"Bot Framework in Node.js - Calling Microsoft Graph (part 6)","slug":"/azurebot-nodejs-part6/","link":null,"excerpt":"I the previous post, we created a new Azure AD Application registration, gave it permissions to…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"March 22, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/fb02b1615213cb512da7d1c78b9ad995/19188/botframework6.png","srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/db297/botframework6.png 190w,\n/static/fb02b1615213cb512da7d1c78b9ad995/19188/botframework6.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/228d6/botframework6.webp 190w,\n/static/fb02b1615213cb512da7d1c78b9ad995/6b99c/botframework6.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/fb02b1615213cb512da7d1c78b9ad995/5fb32/botframework6.png","srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/739fd/botframework6.png 600w,\n/static/fb02b1615213cb512da7d1c78b9ad995/5fb32/botframework6.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/288e3/botframework6.webp 600w,\n/static/fb02b1615213cb512da7d1c78b9ad995/5b893/botframework6.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"084e9867-ec33-5a14-9e1f-d91f4280dac2","title":"Azure AD & Microsoft Graph OAuth Connection, with Azure CLI","slug":"/azcli-connection/","link":null,"excerpt":"In the previous post  Azure AD & Microsoft Graph permission scopes, with Azure CLI , we registered…","timeToRead":1,"featured":null,"thumbnailText":null,"date":"March 11, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/fba499085724398a27f00be5af554b7e/19188/azcli-connection.png","srcSet":"/static/fba499085724398a27f00be5af554b7e/db297/azcli-connection.png 190w,\n/static/fba499085724398a27f00be5af554b7e/19188/azcli-connection.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/fba499085724398a27f00be5af554b7e/228d6/azcli-connection.webp 190w,\n/static/fba499085724398a27f00be5af554b7e/6b99c/azcli-connection.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/fba499085724398a27f00be5af554b7e/5fb32/azcli-connection.png","srcSet":"/static/fba499085724398a27f00be5af554b7e/739fd/azcli-connection.png 600w,\n/static/fba499085724398a27f00be5af554b7e/5fb32/azcli-connection.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/fba499085724398a27f00be5af554b7e/288e3/azcli-connection.webp 600w,\n/static/fba499085724398a27f00be5af554b7e/5b893/azcli-connection.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"d45b509b-06e7-5f59-9963-ab5041c1c9ec","title":"Azure AD & Microsoft Graph permission scopes, with Azure CLI","slug":"/azcli-adscope/","link":null,"excerpt":"In this small post, we will look at a scenario where we want to register an Azure AD Application…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"March 09, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/e5aceb9744ad9f189605a624aef5497e/19188/azcli-scopes.png","srcSet":"/static/e5aceb9744ad9f189605a624aef5497e/db297/azcli-scopes.png 190w,\n/static/e5aceb9744ad9f189605a624aef5497e/19188/azcli-scopes.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/e5aceb9744ad9f189605a624aef5497e/228d6/azcli-scopes.webp 190w,\n/static/e5aceb9744ad9f189605a624aef5497e/6b99c/azcli-scopes.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/e5aceb9744ad9f189605a624aef5497e/5fb32/azcli-scopes.png","srcSet":"/static/e5aceb9744ad9f189605a624aef5497e/739fd/azcli-scopes.png 600w,\n/static/e5aceb9744ad9f189605a624aef5497e/5fb32/azcli-scopes.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/e5aceb9744ad9f189605a624aef5497e/288e3/azcli-scopes.webp 600w,\n/static/e5aceb9744ad9f189605a624aef5497e/5b893/azcli-scopes.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}}]},"previous":{"id":"084e9867-ec33-5a14-9e1f-d91f4280dac2","slug":"/azcli-connection/","title":"Azure AD & Microsoft Graph OAuth Connection, with Azure CLI"},"next":{"id":"0ed2d4e8-d282-5d9c-b490-c2ce1b500a61","slug":"/azurebot-nodejs-part6/","title":"Bot Framework in Node.js - Calling Microsoft Graph (part 6)"}},"pageContext":{"id":"31e75b40-8c93-54fb-bbfe-58e742083902","categoryId":"64f10eaf-091c-555c-a28e-13a12e934b04","tagsIds":["4a3b863b-2ddd-5eae-8e53-b85dea2ea045","ebfba2f8-5479-5edb-b0af-a656cd15bfa4","3854a95d-b2b2-52b0-a0d7-8e558721d1e6"],"hasTags":true,"previousId":"084e9867-ec33-5a14-9e1f-d91f4280dac2","nextId":"0ed2d4e8-d282-5d9c-b490-c2ce1b500a61","paginatePostsPage":true,"basePath":"/","services":{"algolia":true,"mailchimp":false,"disqus":false,"graphComment":true,"facebookComment":false},"siteUrl":"https://www.agrenpoint.com","mobileMenu":{"title":"Topics","items":[{"name":"Azure","slug":"/category/azure/"},{"name":"Endpoint management","slug":"/category/endpoint-management/"},{"name":"Microsoft 365","slug":"/category/microsoft-365/"}]},"darkMode":true,"includeExcerpt":true,"includeTimeToRead":true,"includeTableOfContents":true,"imageQuality":75,"currentDate":"2026-03-02"}},"staticQueryHashes":["1992822086","2409295108","2925947909"]}
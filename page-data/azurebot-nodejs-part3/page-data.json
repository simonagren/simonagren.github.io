{"componentChunkName":"component---packages-blog-gatsby-blog-core-src-templates-post-js","path":"/azurebot-nodejs-part3/","result":{"data":{"post":{"id":"41732e06-3e2a-5b5c-93a7-e89f10c0bae6","title":"Bot Framework in Node.js - Dialogs (Part 3)","slug":"/azurebot-nodejs-part3/","link":null,"excerpt":"In the previous post, we tried the Bot in Microsoft Teams using  ngrok , and we also added a…","tableOfContents":{"items":[{"items":[{"url":"#what-we-will-build-today","title":"What we will build today"}]},{"url":"#sourcecode","title":"Sourcecode"},{"url":"#prerequisites","title":"Prerequisites"},{"url":"#dialogs-in-bot-framework-4","title":"Dialogs in Bot Framework 4","items":[{"url":"#prompts","title":"Prompts"},{"url":"#waterfall-dialogs","title":"Waterfall dialogs"},{"url":"#component-dialogs","title":"Component dialogs"}]},{"url":"#project-changes","title":"Project changes","items":[{"url":"#files-we-added","title":"Files we added"},{"url":"#botts","title":"bot.ts"},{"url":"#indexts","title":"Index.ts"},{"url":"#maindialogts","title":"mainDialog.ts"},{"url":"#sitedialogts","title":"siteDialog.ts"},{"url":"#ownerresolverdialog","title":"OwnerResolverDialog"}]},{"url":"#next-step","title":"Next step"}]},"timeToRead":5,"featured":null,"protected":null,"thumbnailText":null,"date":"March 04, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"body":"var _excluded = [\"components\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (-1 !== e.indexOf(n)) continue; t[n] = r[n]; } return t; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"Bot Framework in Node.js - Dialogs (Part 3)\",\n  \"tags\": [\"botframework\"],\n  \"thumbnail\": \"botframework3.png\",\n  \"author\": \"Simon Ågren\",\n  \"date\": \"2020-03-04T00:00:00.000Z\",\n  \"category\": \"Azure\",\n  \"slug\": \"azurebot-nodejs-part3\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"In the previous post, we tried the Bot in Microsoft Teams using \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"ngrok\"), \", and we also added a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"@mention\"), \". \"), mdx(\"p\", null, \"This post will be a bit code-heavy. A lot needed to be explained and a lot going on behind the scenes. Hopefully, this puts things a bit into context. \"), mdx(\"p\", null, \"Dialogs are powerful in Bot Framework 4, and we could utilize them in very structured ways, and complicated branched conditional situations. \"), mdx(\"p\", null, \"I will try to stick to the basics, but at the same time prepare the Bot for upcoming posts.\"), mdx(\"table\", null, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Bot Framework in Node.js\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Complimentary post\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azurebot-nodejs-part1\",\n    target: \"_blank\"\n  }, \"Let\\u2019s begin (Part 1)\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azurebot-armtemplate-keyvault\",\n    target: \"_blank\"\n  }, \"Bot Framework 4 ARM template Deploy with Key Vault\"))), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azurebot-nodejs-part2\",\n    target: \"_blank\"\n  }, \"Microsoft Teams (Part 2)\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  })), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Dialogs (Part 3)\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  })), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azurebot-nodejs-part4\",\n    target: \"_blank\"\n  }, \"Interruptions (Part 4)\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  })), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azurebot-nodejs-part5\",\n    target: \"_blank\"\n  }, \"Auth and Microsoft Graph (Part 5)\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azcli-adscope\",\n    target: \"_blank\"\n  }, \"Azure AD & Microsoft Graph permission scopes, with Azure CLI\"))), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azcli-connection\",\n    target: \"_blank\"\n  }, \"Azure AD & Microsoft Graph OAuth Connection, with Azure CLI\"))), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"a\", {\n    href: \"https://www.agrenpoint.com/azurebot-nodejs-part6\",\n    target: \"_blank\"\n  }, \"Calling Microsoft Graph (Part 6)\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  })))), mdx(\"h2\", {\n    \"id\": \"what-we-will-build-today\"\n  }, \"What we will build today\"), mdx(\"img\", {\n    \"src\": \"/6f8cc0596169838afaaa698fc511369e/bot.gif\"\n  }), mdx(\"h1\", {\n    \"id\": \"sourcecode\"\n  }, \"Sourcecode\"), mdx(\"p\", null, \"Here is the link to the Github repository for this post: \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/simonagren/simon-blog-bot-v3\"\n  }, \"https://github.com/simonagren/simon-blog-bot-v3\")), mdx(\"h1\", {\n    \"id\": \"prerequisites\"\n  }, \"Prerequisites\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://aka.ms/Emulator-wiki-getting-started\"\n  }, \"Bot Emulator\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://nodejs.org/en/download/\"\n  }, \"Node.js 10.4+\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://code.visualstudio.com/\"\n  }, \"Visual Studio Code\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://azure.microsoft.com/free/\"\n  }, \"An Azure Account\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://developer.microsoft.com/office/dev-program\"\n  }, \"Office 365 dev tenant\"), \" - for Microsoft Teams\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://ngrok.com/download\"\n  }, \"Ngrok\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://docs.microsoft.com/en-us/microsoftteams/platform/concepts/build-and-test/app-studio-overview#installing-app-studio\"\n  }, \"App Studio installed in Teams\"))), mdx(\"h1\", {\n    \"id\": \"dialogs-in-bot-framework-4\"\n  }, \"Dialogs in Bot Framework 4\"), mdx(\"p\", null, \"We have a few different dialogs: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"prompts\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"waterfall dialogs\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"component dialogs\"), \" \"), mdx(\"h2\", {\n    \"id\": \"prompts\"\n  }, \"Prompts\"), mdx(\"p\", null, \"Prompts are used to ask the user for input and wait until the user enters input. If the value is valid the prompt returns the value, otherwise it will re-prompt the user.\\nWe have to ability to define our custom validators for each prompt, and we could could also create our own custom prompts.\"), mdx(\"p\", null, \"There are different prompts available, and among those:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Choice Prompt\"), \": Asks for a choice from a set of options\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Text prompt\"), \": Asks for general text input\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Confirm prompt\"), \": Asks for a confirmation.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Number prompt\"), \":\\tAsks for a number.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"OAuth Prompt\"), \": Asks the user to sign in using the Bot Frameworks Single Sign On (SSO) service\")), mdx(\"h2\", {\n    \"id\": \"waterfall-dialogs\"\n  }, \"Waterfall dialogs\"), mdx(\"p\", null, \"A waterfall dialog is composed of a sequence of steps. Each step of the conversation is implemented as an asynchronous function that takes a waterfall step context parameter.\\nUsually, in each step, we prompt the user for input(for instance a question), which then the user can respond to. \"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"505px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"28.07017543859649%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAoklEQVQY04WQOwpCMRREszR34Arcgr29a7BzATY21i5E5IFNPmI+TQrNbyQJgfAwz4HDnXuLYbiEc44MpRSMMQghyq61RlZKqTBXu+UZM7FCpJRQSpUAY0whe2vtYmAf2os45zDSKGje8KkdHvwN+vqA9C1G/GravA8Jm/2E1faG9e5eA/9p6YchJpyuCoczx/HCQbz3WCKEMPxl3dst5r74Arul0xl8fhJ9AAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"input\",\n    \"title\": \"input\",\n    \"src\": \"/static/e693267b2b950d7cac737a6b627496f7/c0cb9/input.png\",\n    \"srcSet\": [\"/static/e693267b2b950d7cac737a6b627496f7/0e2fe/input.png 285w\", \"/static/e693267b2b950d7cac737a6b627496f7/c0cb9/input.png 505w\"],\n    \"sizes\": \"(max-width: 505px) 100vw, 505px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"input\"), \"\\n  \")), mdx(\"p\", null, \"The input from the user will be passed to the next step. \"), mdx(\"p\", null, \"Another option is to begin a child dialog from a step, and this could be as simple or complex as we want to build the branching.\"), mdx(\"p\", null, \"You could read some more \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.microsoft.com/en-us/azure/bot-service/bot-builder-dialog-manage-complex-conversation-flow?view=azure-bot-service-4.0&tabs=javascript\"\n  }, \"here\"), \" regarding complex conversation flows.\"), mdx(\"h2\", {\n    \"id\": \"component-dialogs\"\n  }, \"Component dialogs\"), mdx(\"p\", null, \"The component dialog makes it easy to create \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"reusable dialogs\"), \" for specific scenarios, and sometimes it makes sense to break up the Bots\\u2019 logic into smaller pieces. A \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"component\"), \" could be added as a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"dialog\"), \" to another \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"ComponentDialog\"), \" or \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"DialogSet\"), \" - we will use both of these scenarios in the Bot. \"), mdx(\"p\", null, \"We can have \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Waterfall dialogs\"), \" and \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"prompts\"), \" in each component and it will have its\\u2019 own \\u201Cdialog flow\\u201D. The dialogs could be imported and run as the main dialog or started as child dialogs.\"), mdx(\"p\", null, \"In our case we will have three components deriving from \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ComponentDialog\"), \":\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The main component that we run from the Bot\", mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"export class MainDialog extends ComponentDialog {\\n\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The site dialog that we will import to and run from \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"MainDialog\"), \" \", mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"export class SiteDialog extends ComponentDialog {\\n\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"And the owner resolver dialog that will be used for displaying an own dialog for validation\", mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"export class OwnerResolverDialog extends ComponentDialog {\\n\")))), mdx(\"h1\", {\n    \"id\": \"project-changes\"\n  }, \"Project changes\"), mdx(\"p\", null, \"This is a high-level visualization of how the Bot is built:\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1140px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"78.94736842105263%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABJ0AAASdAHeZh94AAAEAElEQVQ4y42TW0wTVgCG+74397IYswnKRWFMjRdEBAFvuLlLlix7cTHZMpzCRFtgICgSpghTFEe5DSwUKKgDxFlxK71RaIHSVii9F9ABKupkZlOZhW9p8WV78iRf/vP05Zzk/wUq8wzijjHyqqycbXRQ3urigsxFdvkwuVVWROIRbBNPA1xRT3O97wGZlXZKZW4uyJx8L3WQXT1K+sVhuodmEJxuclLZ4WVjnoGYIhNxJRbizph4L3+Q9SIdkV/8RsOvd2hVTrLvVC9ZlQNsT5ezp2SApLMWPsruIyFVQ9R+BcfrbAhO1Nn44Lie8IpRQqVewn5yEirxENY8TmSJic0HVMgUU8j7p9ia0Up83i12F8hZcX6AZWIbGzJ1JBzTsyFNy6kGF4LsHy28UzBI5OW7RNU6CTupJ6LeQ5TUy7tSN5tybiBVDNHWN8TGTDkhtWOsab3LarGdlQUDrGq6Q2TLNEFn1Fy4okFQ2OBgbYqSLcIeYo5oiTmsYbM/j2jZclTLuq+7uaabRGG8z+aDanZ8p+OT09f4sEDO3pNy9hbI+bjwJluFcirlAwge/znHkOMJFtcTzAFmX+UiJtcsz174mF+ANs0U51rdlP3s5mK7g7J2BxfbnJS1DVPT1c/EoykEvOaxeGY5KbHT0v07e0U9pBYbSS0x8vkxPTuFGpJzO7iqG1kUPv37Jf+8nOf5nI9nrwjcX/h4MecLCDt00ySl97CvaJDgchvh9V4iLrkJueRhV2EnScJ2iq/0I1CaZrismgz0KKfayolX+HuZf8nO4bJhzO5Z/H3dkKIiIVXNW6W3WS6bYHXLBG/WONiWpSb2UDel7f0I/MXMqRlll1DHnpw+tp82sbPIRFLhIJ/l60k8okXSNYHG8phNKRoSRb0Ei62savYS1eQhSOIk+piB2G8UnGs3IMiutrL2KyW7j+qIFmkJqXESUesmUnyb5LwOEkW/IFEakBvtxKV1syNHQUjVCEENXlbWewiWuIjO1f9XuDVNS7JIx5bMHiLKrayvshFRaub93C62i25RfauP60YjiaKbfJrXSdA5A8sbvIRK3SytGCFeqAt8OSD0L8X/wm1pWtZ/qyH0jIWoH4YJLzSSIOpi08EbXO1xoTI/YGOKlp3pvbxdbCZc6mFdo4elYivxGX6hglK/8N6j54FRq8wP0Zhm0AzcR91/D+3gA5RDj1EYH+Hzwc3++8QcUpMs7CHkvIVg2RghzWOsqLMTl2Eg9pCas22G1++h2vyQNV8qiT2gYkmRmSX14yxrGOcNsY3YLDnRqVep8C9lfmEB3/wCPt/8Yv4f30JAOPdynqrOMTIrRkivtyFsdpIlc5LeaCenbojiFgv3/viLfwHaLLBNahLIRwAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"diagram\",\n    \"title\": \"diagram\",\n    \"src\": \"/static/31b8adcc2e3dfe06a196d1a677825fac/b5cea/botdiagram.png\",\n    \"srcSet\": [\"/static/31b8adcc2e3dfe06a196d1a677825fac/0e2fe/botdiagram.png 285w\", \"/static/31b8adcc2e3dfe06a196d1a677825fac/432e7/botdiagram.png 570w\", \"/static/31b8adcc2e3dfe06a196d1a677825fac/b5cea/botdiagram.png 1140w\", \"/static/31b8adcc2e3dfe06a196d1a677825fac/68947/botdiagram.png 1281w\"],\n    \"sizes\": \"(max-width: 1140px) 100vw, 1140px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"diagram\"), \"\\n  \")), mdx(\"h2\", {\n    \"id\": \"files-we-added\"\n  }, \"Files we added\"), mdx(\"p\", null, \"In the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"src\"), \" folder, we create an additional folder named \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"dialogs\"), \". It will contain 4 new files:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"mainDialog.ts\"), \": The main dialog will now at first just kick off the \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"siteDialog\"), \" and then collect the results. In upcoming posts, we will add some additional steps.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"siteDetails.ts\"), \": the class that defines all the properties we use and need.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"siteDialog.ts\"), \":  Will contain the conversational flow between the user and the Bot, where the user \\u201Corders\\u201D a site.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"ownerResolverDialog\"), \": an example where we create a new dialog to validate user input.      \")), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"499px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"116.84210526315788%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACQElEQVQ4y6WV2XKbMBSGeZLGBoEkdrFjZAy2u0wzff/H+TrgtBM3bey4F//ogqNPZ8eRUtO2HYfDRN/1DLsBa0f21hLHMZ4n8P0AIfx3tdi4rocTZ4am68mLkiTPibOc1BSYsiJKM1QUo29otYkTfKlwwigmy82qNMsxRYnS+vJqIAmkulvLHUfpEGMKwjBEKb2eQSBvhvgmZOFfQpZSUZUVJjd4rodYcvaSk9/nDf3Koed5OCJQREW95lHHMe7y4ZXEC1i888AVMBc++zjlx27gmGaYT0+UW5fa9Shdj+AVTNzjYSsCTFlzHA8cBkuRpiQ6RGxd9Nal3WyvoDeBpS8JTLP2ot2PHE8nhmFPnhuiNMcoReF6a/i3crkCC+EjTU3btNjBMgyWqqrp2pam7ciThOJpw3bx0hNro/9NQghc18Xpw4SkGRj3E/N85jifKYoKEWgCHdEHmkIvDZwQhQnhPxRFKcvUOceyoxw/M5++cf76zPnLM3Y3Yk3DOasY8xqz2NxQVfUkSY5T+5K9KfluLVNRkj1tqDdb8q2L9ATu2rjiDvmXkAOtOTQNz/ORqWlIpVpn0lum5Y5CvC1KJWm7lnGaafsdvd2vxQmX1nlkUjIj6buW6TAxjiNN014Z3QO9AsqsphssdvHMLi1T4Xn3w94Ao92Juh+ww8A8z9R1syb5YvxoyH3HdJjZ7QbUy177SDGugKkxK2iZkOU3cL32HwAGgUKpEK1DomWdK/1/Hoo/ZvQj1f0r8D2DR4A/AZTNq28kMyF9AAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"newfiles\",\n    \"title\": \"newfiles\",\n    \"src\": \"/static/82e1709e24d2b30501cd4c40346facea/119c7/newfiles.png\",\n    \"srcSet\": [\"/static/82e1709e24d2b30501cd4c40346facea/0e2fe/newfiles.png 285w\", \"/static/82e1709e24d2b30501cd4c40346facea/119c7/newfiles.png 499w\"],\n    \"sizes\": \"(max-width: 499px) 100vw, 499px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"newfiles\"), \"\\n  \")), mdx(\"h2\", {\n    \"id\": \"botts\"\n  }, \"bot.ts\"), mdx(\"p\", null, \"We have also done a few changes in the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"bot.ts\"), \" file\"), mdx(\"h3\", {\n    \"id\": \"imports\"\n  }, \"Imports\"), mdx(\"p\", null, \"We added some more imports from \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"botbuilder\"), \" for handling state in the dialogs, and a few from \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"botbuilder-dialogs\"), \". We have also imported the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"MainDialog\"), \" that we will run. \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"import {\\n  Activity,\\n  ActivityHandler,\\n  ActivityTypes,\\n  BotState,\\n  ChannelAccount,\\n  ConversationState,\\n  Mention,\\n  StatePropertyAccessor,\\n  TurnContext,\\n  UserState\\n} from 'botbuilder';\\nimport { Dialog, DialogState } from 'botbuilder-dialogs';\\nimport { MainDialog } from '../dialogs/mainDialog'; \\n\")), mdx(\"p\", null, \"And handling state is not in the scope of this post, you can read more \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.microsoft.com/en-us/azure/bot-service/bot-builder-concept-state?view=azure-bot-service-4.0\"\n  }, \"here\")), mdx(\"h3\", {\n    \"id\": \"variables-and-constructor\"\n  }, \"Variables and constructor\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Before the constructor, we have added a few private variables.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The constructor now expects properties \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"conversationState\"), \", a \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"userState\"), \" and a \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"dialog\"), \", that we need to supply when creating an instance of the Bot later.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"After making sure that we get these properties, we initialize the private variables with the values we got in. \")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"private conversationState: BotState;\\nprivate userState: BotState;\\nprivate dialog: Dialog;\\nprivate dialogState: StatePropertyAccessor<DialogState>;\\n/**\\n  *\\n  * @param {ConversationState} conversationState\\n  * @param {UserState} userState\\n  * @param {Dialog} dialog\\n  */\\nconstructor(\\n  conversationState: BotState,\\n  userState: BotState,\\n  dialog: Dialog\\n) {\\n  super();\\n  if (!conversationState) {\\n      throw new Error('[SimonBot]: Missing parameter. conversationState is required');\\n  }\\n  if (!userState) {\\n      throw new Error('[SimonBot]: Missing parameter. userState is required');\\n  }\\n  if (!dialog) {\\n      throw new Error('[SimonBot]: Missing parameter. dialog is required');\\n  }\\n  this.conversationState = conversationState as ConversationState;\\n  this.userState = userState as UserState;\\n  this.dialog = dialog;\\n  this.dialogState = this.conversationState.createProperty<DialogState>('DialogState');\\n  ...\\n  \\n\")), mdx(\"h3\", {\n    \"id\": \"method-changes\"\n  }, \"Method changes\"), mdx(\"p\", null, \"The \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"onMessage\"), \" method will now run the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"MainDialog\"), \" with the current \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"context\"), \" and \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"dialogState\"), \". Before it sent back a message to the user \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"@mention\"), \" and echoing what was written to the Bot.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"this.onMessage(async (context, next) => {\\n\\n  // Run the Dialog with the new message Activity.\\n  await (this.dialog as MainDialog).run(context, this.dialogState);\\n\\n  // By calling next() you ensure that the next BotHandler is run.\\n  await next();\\n  });\\n\")), mdx(\"p\", null, \"We have added the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"onDialog\"), \" method to save the state changes.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"this.onDialog(async (context, next) => {\\n  // Save any state changes. The load happened during the execution of the Dialog.\\n  await this.conversationState.saveChanges(context, false);\\n  await this.userState.saveChanges(context, false);\\n\\n  // By calling next() you ensure that the next BotHandler is run.\\n  await next();\\n});\\n\")), mdx(\"p\", null, \"The \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"onMembersAdded\"), \" have instead gotten the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"@mention\"), \" part (slightly changed).\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"this.onMembersAdded(async (context, next) => {\\n  const membersAdded = context.activity.membersAdded;\\n  for (const member of membersAdded) {\\n    if (member.id !== context.activity.recipient.id) {\\n      // If we are in Microsoft Teams\\n      if (context.activity.channelId === 'msteams') {\\n        // Send a message with an @Mention\\n        await this._messageWithMention(context, member);\\n      } else {\\n        // Otherwise we send a normal echo\\n        await context.sendActivity(`Welcome to Simon Bot ${member.name}. This Bot is a work in progress. At this time we have some dialogs working. Type anything to get started.`);\\n      }\\n    }\\n  }\\n\")), mdx(\"h2\", {\n    \"id\": \"indexts\"\n  }, \"Index.ts\"), mdx(\"h3\", {\n    \"id\": \"imports-1\"\n  }, \"Imports\"), mdx(\"p\", null, \"Here we also used to have a single import from \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"botbuilder\"), \" and now we have a couple more imports from. We have also imported the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"MainDialog\"), \" that we will use and inject in the Bot class instance. \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"import { BotFrameworkAdapter, ConversationState, MemoryStorage, UserState } from 'botbuilder';\\nimport { MainDialog } from './dialogs/mainDialog';\\nimport { SimonBot } from './bots/bot';  \\n\")), mdx(\"h3\", {\n    \"id\": \"code-changes\"\n  }, \"Code changes\"), mdx(\"p\", null, \"in \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"adapter.onTurnError\"), \" at the end of the method, we have added some code to delete the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"conversationState\"), \" on error.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"await conversationState.delete(context);\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"First, we set up the required instances of \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"ConversationState\"), \" and \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"UserState\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Then, we initialize an instance of the \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"MainDialog\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"And finally, create a new Bot instance with the required properties.\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"let conversationState: ConversationState;\\nlet userState: UserState;\\n\\nconst memoryStorage = new MemoryStorage();\\nconversationState = new ConversationState(memoryStorage);\\nuserState = new UserState(memoryStorage);\\n\\nconst dialog = new MainDialog('mainDialog');\\nconst myBot = new SimonBot(conversationState, userState, dialog);\\n\")), mdx(\"h2\", {\n    \"id\": \"maindialogts\"\n  }, \"mainDialog.ts\"), mdx(\"p\", null, \"The main dialog consists of two steps \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"initialStep\"), \" and \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"finalStep\"), \". That will kick off the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"siteDialog\"), \" and then collect the result.\"), mdx(\"p\", null, \"At first, we add some constants. It\\u2019s the name of the dialogs we will add.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"const SITE_DIALOG = 'siteDialog';\\nconst MAIN_WATERFALL_DIALOG = 'waterfallDialog';\\n\")), mdx(\"p\", null, \"Then later we use them in the constructor while adding the dialogs we want.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"constructor(id: string) {\\n    super(id);\\n\\n    this.addDialog(new SiteDialog(SITE_DIALOG))\\n        .addDialog(new WaterfallDialog(MAIN_WATERFALL_DIALOG, [\\n            this.initialStep.bind(this),\\n            this.finalStep.bind(this)\\n        ]));\\n\\n    this.initialDialogId = MAIN_WATERFALL_DIALOG;\\n  }\\n}  \\n\")), mdx(\"p\", null, \"First, we add the dialogs we will use, there\\u2019s the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"SiteDialog\"), \" and a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"WaterFallDialog\"), \". The Waterfall Dialog contains steps, and these have been added in the sequence they are intended to be run. \"), mdx(\"h3\", {\n    \"id\": \"initialstep\"\n  }, \"initialStep\"), mdx(\"p\", null, \"This step creates a new instance of the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"SiteDetails\"), \" class and injects it while starting the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"siteDialog\"), \" child dialog. We are using the constant \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"SITE_DIALOG\"), \" to make sure there are no spelling errors.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"private async initialStep(stepContext: WaterfallStepContext): Promise<DialogTurnResult> {\\n    const siteDetails = new SiteDetails();\\n    return await stepContext.beginDialog(SITE_DIALOG, siteDetails);\\n}\\n\")), mdx(\"h3\", {\n    \"id\": \"finalstep\"\n  }, \"finalStep\"), mdx(\"p\", null, \"In this step, we collect the result from the previous step. It\\u2019s the result of all the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"siteDialog\"), \" steps. This is where we would typically save something to a \\u201Cdatabase\\u201D.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"private async finalStep(stepContext: WaterfallStepContext): Promise<DialogTurnResult> {\\n    if (stepContext.result) {\\n        const result = stepContext.result as SiteDetails;\\n        const msg = `I have created a ${ JSON.stringify(result) }`;\\n        await stepContext.context.sendActivity(msg);\\n    }\\n    return await stepContext.endDialog();\\n}\\n\")), mdx(\"h2\", {\n    \"id\": \"sitedialogts\"\n  }, \"siteDialog.ts\"), mdx(\"p\", null, \"The site dialog consists of multiple \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"prompts\"), \", the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"OwnerResolverDialog\"), \" and another \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"WaterFallDialog\"), \".\"), mdx(\"p\", null, \"This is what the constructor looks like:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"constructor(id: string) {\\n    super(id || 'siteDialog');\\n    this\\n        .addDialog(new ChoicePrompt(CHOICE_PROMPT))\\n        .addDialog(new TextPrompt(TEXT_PROMPT))\\n        .addDialog(new OwnerResolverDialog(OWNER_RESOLVER_DIALOG))\\n        .addDialog(new ConfirmPrompt(CONFIRM_PROMPT))\\n        .addDialog(new WaterfallDialog(WATERFALL_DIALOG, [\\n            this.siteTypeStep.bind(this),\\n            this.titleStep.bind(this),\\n            this.descriptionStep.bind(this),\\n            this.ownerStep.bind(this),\\n            this.aliasStep.bind(this),\\n            this.confirmStep.bind(this),\\n            this.finalStep.bind(this)\\n        ]));\\n    this.initialDialogId = WATERFALL_DIALOG;\\n}   \\n\")), mdx(\"h3\", {\n    \"id\": \"sitetypestep\"\n  }, \"SiteTypeStep\"), mdx(\"p\", null, \"The first \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"siteTypeStep\"), \" will use a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"ChoicePrompt\"), \". \"), mdx(\"p\", null, \"We will use the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"WaterFallStepContext\"), \" to populate \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"siteDetails\"), \" with values in every step. \"), mdx(\"p\", null, \"If we don\\u2019t have a siteType value in siteDetails, we will prompt the user. In this case, we use the dialog/prompt we added using the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"CHOICE_PROMPT\"), \". \"), mdx(\"p\", null, \"And if we have a value, we will just run \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \".next(siteDetails.siteType)\"), \" and send the value to the next step in the WaterFall Dialog.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"private async siteTypeStep(stepContext: WaterfallStepContext): Promise<DialogTurnResult> {\\n  const siteDetails = stepContext.options as SiteDetails;\\n\\n  if (!siteDetails.siteType) {\\n\\n      return await stepContext.prompt(CHOICE_PROMPT, {\\n          choices: ChoiceFactory.toChoices(['Team Site', 'Communication Site']),\\n          prompt: 'Select site type.'\\n      });\\n\\n  } else {\\n      return await stepContext.next(siteDetails.siteType);\\n  }\\n}\\n\")), mdx(\"h3\", {\n    \"id\": \"titlestep\"\n  }, \"TitleStep\"), mdx(\"p\", null, \"The second step \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"siteTitleStep\"), \" will use a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"TextPrompt\"), \".\"), mdx(\"p\", null, \"We will first get the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"siteType\"), \" value from the previous step.\\nAnd as in the previous step, if we don\\u2019t have the value from the user, we will prompt the user. And if we have a value, we will just run \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \".next(siteDetails.title)\"), \" and send the value to the next step in the WaterFall Dialog.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"private async titleStep(stepContext: WaterfallStepContext): Promise<DialogTurnResult> {\\n  const siteDetails = stepContext.options as SiteDetails;\\n\\n  siteDetails.siteType = stepContext.result;\\n\\n  if (!siteDetails.title) {\\n\\n      const promptText = 'Provide a title for your site';\\n      return await stepContext.prompt(TEXT_PROMPT, { prompt: promptText });\\n  } else {\\n      return await stepContext.next(siteDetails.title);\\n  }\\n}\\n\")), mdx(\"h3\", {\n    \"id\": \"ownerstep\"\n  }, \"OwnerStep\"), mdx(\"p\", null, \"The \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"ownerStep\"), \" will not use any of the prompts we added. It will instead kick off the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"OwnerResolverDialog\"), \".\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"private async ownerStep(stepContext: WaterfallStepContext): Promise<DialogTurnResult> {\\n  const siteDetails = stepContext.options as SiteDetails;\\n\\n  // Capture the results of the previous step\\n  siteDetails.description = stepContext.result;\\n\\n  if (!siteDetails.owner) {\\n      return await stepContext.beginDialog(OWNER_RESOLVER_DIALOG, { siteDetails });\\n  } else {\\n      return await stepContext.next(siteDetails.owner);\\n  }\\n}\\n\")), mdx(\"h2\", {\n    \"id\": \"ownerresolverdialog\"\n  }, \"OwnerResolverDialog\"), mdx(\"p\", null, \"I have created a dialog similar to the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"MainDialog\"), \" only a bit smaller.\"), mdx(\"p\", null, \"We also add a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"prompt\"), \" here and a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"WaterFallDialog\"), \", but only two steps - an initial and final step.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"this\\n  .addDialog(\\n    new TextPrompt(TEXT_PROMPT, OwnerResolverDialog.ownerPromptValidator.bind(this))\\n  ).addDialog(\\n    new WaterfallDialog(WATERFALL_DIALOG, [\\n      this.initialStep.bind(this),\\n      this.finalStep.bind(this)\\n  ]));\\n\\nthis.initialDialogId = WATERFALL_DIALOG;\\n}\\n\")), mdx(\"p\", null, \"Here we supply a validation method to the text prompt. Sometimes we need multiple validation methods, we will add some extra validation here in another post using \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Microsoft Graph\"), \" to see that the user exists.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"private static async ownerPromptValidator(promptContext: PromptValidatorContext<string>): Promise<boolean> {\\n  if (promptContext.recognized.succeeded) {\\n    const owner: string = promptContext.recognized.value;\\n    // Regex for email\\n    if (!OwnerResolverDialog.validateEmail(owner)) {\\n      promptContext.context.sendActivity('Malformatted email adress.');\\n      return false;\\n    } else {\\n      return true;\\n    }\\n\\n  } else {\\n    return false;\\n  }\\n}\\n\")), mdx(\"p\", null, \"This is how the steps look like, they should be familiar. Note that we don\\u2019t use a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"repromtMessage\"), \" since we handle the message to the user in the validator method.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"private async initialStep(stepContext: WaterfallStepContext): Promise<DialogTurnResult> {\\n  const siteDetails = (stepContext.options as any).siteDetails;\\n\\n  const promptMsg = 'Provide an owner email';\\n\\n  if (!siteDetails.owner) {\\n    return await stepContext.prompt(TEXT_PROMPT, {\\n      prompt: promptMsg\\n    });\\n  } else {\\n    return await stepContext.next(siteDetails.owner);\\n  }\\n}\\n\\nprivate async finalStep(stepContext: WaterfallStepContext): Promise<DialogTurnResult> {\\n  const owner = stepContext.result;\\n  return await stepContext.endDialog(owner);\\n}\\n\")), mdx(\"h1\", {\n    \"id\": \"next-step\"\n  }, \"Next step\"), mdx(\"p\", null, \"The next post will be a short one focusing on how to handle user interruptions. If the user asks for help or restarts the Bot.\"));\n}\n;\nMDXContent.isMDXComponent = true;","keywords":null,"tags":[{"id":"4a3b863b-2ddd-5eae-8e53-b85dea2ea045","name":"botframework","slug":"/tag/botframework/"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/f0bbb24c1a8bf567d48e95abd710cb89/19188/botframework3.png","srcSet":"/static/f0bbb24c1a8bf567d48e95abd710cb89/db297/botframework3.png 190w,\n/static/f0bbb24c1a8bf567d48e95abd710cb89/19188/botframework3.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/f0bbb24c1a8bf567d48e95abd710cb89/228d6/botframework3.webp 190w,\n/static/f0bbb24c1a8bf567d48e95abd710cb89/6b99c/botframework3.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/f0bbb24c1a8bf567d48e95abd710cb89/5fb32/botframework3.png","srcSet":"/static/f0bbb24c1a8bf567d48e95abd710cb89/739fd/botframework3.png 600w,\n/static/f0bbb24c1a8bf567d48e95abd710cb89/5fb32/botframework3.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/f0bbb24c1a8bf567d48e95abd710cb89/288e3/botframework3.webp 600w,\n/static/f0bbb24c1a8bf567d48e95abd710cb89/5b893/botframework3.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},"tagCategoryPosts":{"nodes":[{"id":"95bc278d-e498-54ab-9a09-4392f627a596","title":"Bot Framework in Node.js - Proactive messages and token validation","slug":"/azurebot-nodejs-part8/","link":null,"excerpt":"In the last post we got a little fancy using Adaptive cards in the Bot. We talked about workarounds…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 10, 2021","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/0011cc7c64bf6a7a48e29df018eb1adf/19188/botframework8.png","srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/db297/botframework8.png 190w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/19188/botframework8.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/228d6/botframework8.webp 190w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/6b99c/botframework8.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/0011cc7c64bf6a7a48e29df018eb1adf/5fb32/botframework8.png","srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/739fd/botframework8.png 600w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/5fb32/botframework8.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/288e3/botframework8.webp 600w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/5b893/botframework8.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"47fa3c51-0e3f-5954-bc51-298d260844de","title":"Bot Framework in Node.js - Adaptive Cards (part 7)","slug":"/azurebot-nodejs-part7/","link":null,"excerpt":"In the previous post, we added some helpers and enabled the user to call Microsoft Graph. We used…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 08, 2021","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/b8577e12e0c806356bde4bd7135e8bcf/19188/botframework7.png","srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/db297/botframework7.png 190w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/19188/botframework7.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/228d6/botframework7.webp 190w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/6b99c/botframework7.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/b8577e12e0c806356bde4bd7135e8bcf/5fb32/botframework7.png","srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/739fd/botframework7.png 600w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/5fb32/botframework7.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/288e3/botframework7.webp 600w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/5b893/botframework7.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"f22060a9-6d2c-5f4c-afb8-98a59bdcc540","title":"Microsoft Graph Presence API - top of mind scenarios","slug":"/graph-presence/","link":null,"excerpt":"The new presence API in Microsoft Graph is very popular. We've seen a lot of blog post where people…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 06, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/9349ac165f3b22a5d70d0a19c66bd235/19188/presence.png","srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/db297/presence.png 190w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/19188/presence.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/228d6/presence.webp 190w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/6b99c/presence.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/9349ac165f3b22a5d70d0a19c66bd235/945a8/presence.png","srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/17e9b/presence.png 800w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/945a8/presence.png 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"},"sources":[{"srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/c9f06/presence.webp 800w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/f47df/presence.webp 1600w","type":"image/webp","sizes":"(min-width: 1600px) 1600px, 100vw"}]},"width":1600,"height":650}}},{"id":"0ed2d4e8-d282-5d9c-b490-c2ce1b500a61","title":"Bot Framework in Node.js - Calling Microsoft Graph (part 6)","slug":"/azurebot-nodejs-part6/","link":null,"excerpt":"I the previous post, we created a new Azure AD Application registration, gave it permissions to…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"March 22, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/fb02b1615213cb512da7d1c78b9ad995/19188/botframework6.png","srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/db297/botframework6.png 190w,\n/static/fb02b1615213cb512da7d1c78b9ad995/19188/botframework6.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/228d6/botframework6.webp 190w,\n/static/fb02b1615213cb512da7d1c78b9ad995/6b99c/botframework6.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/fb02b1615213cb512da7d1c78b9ad995/5fb32/botframework6.png","srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/739fd/botframework6.png 600w,\n/static/fb02b1615213cb512da7d1c78b9ad995/5fb32/botframework6.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/288e3/botframework6.webp 600w,\n/static/fb02b1615213cb512da7d1c78b9ad995/5b893/botframework6.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"31e75b40-8c93-54fb-bbfe-58e742083902","title":"Bot Framework in Node.js - Auth and Microsoft Graph (part 5)","slug":"/azurebot-nodejs-part5/","link":null,"excerpt":"In the previous post, we had a look at user interruptions. In this post, we will look at how to…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"March 13, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/d069abc39a202859cea11fc120ae11c0/19188/botframework5.png","srcSet":"/static/d069abc39a202859cea11fc120ae11c0/db297/botframework5.png 190w,\n/static/d069abc39a202859cea11fc120ae11c0/19188/botframework5.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/d069abc39a202859cea11fc120ae11c0/228d6/botframework5.webp 190w,\n/static/d069abc39a202859cea11fc120ae11c0/6b99c/botframework5.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/d069abc39a202859cea11fc120ae11c0/5fb32/botframework5.png","srcSet":"/static/d069abc39a202859cea11fc120ae11c0/739fd/botframework5.png 600w,\n/static/d069abc39a202859cea11fc120ae11c0/5fb32/botframework5.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/d069abc39a202859cea11fc120ae11c0/288e3/botframework5.webp 600w,\n/static/d069abc39a202859cea11fc120ae11c0/5b893/botframework5.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"084e9867-ec33-5a14-9e1f-d91f4280dac2","title":"Azure AD & Microsoft Graph OAuth Connection, with Azure CLI","slug":"/azcli-connection/","link":null,"excerpt":"In the previous post  Azure AD & Microsoft Graph permission scopes, with Azure CLI , we registered…","timeToRead":1,"featured":null,"thumbnailText":null,"date":"March 11, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/fba499085724398a27f00be5af554b7e/19188/azcli-connection.png","srcSet":"/static/fba499085724398a27f00be5af554b7e/db297/azcli-connection.png 190w,\n/static/fba499085724398a27f00be5af554b7e/19188/azcli-connection.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/fba499085724398a27f00be5af554b7e/228d6/azcli-connection.webp 190w,\n/static/fba499085724398a27f00be5af554b7e/6b99c/azcli-connection.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/fba499085724398a27f00be5af554b7e/5fb32/azcli-connection.png","srcSet":"/static/fba499085724398a27f00be5af554b7e/739fd/azcli-connection.png 600w,\n/static/fba499085724398a27f00be5af554b7e/5fb32/azcli-connection.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/fba499085724398a27f00be5af554b7e/288e3/azcli-connection.webp 600w,\n/static/fba499085724398a27f00be5af554b7e/5b893/azcli-connection.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}}]},"tagPosts":{"nodes":[{"id":"95bc278d-e498-54ab-9a09-4392f627a596","title":"Bot Framework in Node.js - Proactive messages and token validation","slug":"/azurebot-nodejs-part8/","link":null,"excerpt":"In the last post we got a little fancy using Adaptive cards in the Bot. We talked about workarounds…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 10, 2021","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/0011cc7c64bf6a7a48e29df018eb1adf/19188/botframework8.png","srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/db297/botframework8.png 190w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/19188/botframework8.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/228d6/botframework8.webp 190w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/6b99c/botframework8.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/0011cc7c64bf6a7a48e29df018eb1adf/5fb32/botframework8.png","srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/739fd/botframework8.png 600w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/5fb32/botframework8.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/288e3/botframework8.webp 600w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/5b893/botframework8.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"47fa3c51-0e3f-5954-bc51-298d260844de","title":"Bot Framework in Node.js - Adaptive Cards (part 7)","slug":"/azurebot-nodejs-part7/","link":null,"excerpt":"In the previous post, we added some helpers and enabled the user to call Microsoft Graph. We used…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 08, 2021","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/b8577e12e0c806356bde4bd7135e8bcf/19188/botframework7.png","srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/db297/botframework7.png 190w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/19188/botframework7.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/228d6/botframework7.webp 190w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/6b99c/botframework7.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/b8577e12e0c806356bde4bd7135e8bcf/5fb32/botframework7.png","srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/739fd/botframework7.png 600w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/5fb32/botframework7.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/288e3/botframework7.webp 600w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/5b893/botframework7.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"f22060a9-6d2c-5f4c-afb8-98a59bdcc540","title":"Microsoft Graph Presence API - top of mind scenarios","slug":"/graph-presence/","link":null,"excerpt":"The new presence API in Microsoft Graph is very popular. We've seen a lot of blog post where people…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 06, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/9349ac165f3b22a5d70d0a19c66bd235/19188/presence.png","srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/db297/presence.png 190w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/19188/presence.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/228d6/presence.webp 190w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/6b99c/presence.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/9349ac165f3b22a5d70d0a19c66bd235/945a8/presence.png","srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/17e9b/presence.png 800w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/945a8/presence.png 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"},"sources":[{"srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/c9f06/presence.webp 800w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/f47df/presence.webp 1600w","type":"image/webp","sizes":"(min-width: 1600px) 1600px, 100vw"}]},"width":1600,"height":650}}},{"id":"0ed2d4e8-d282-5d9c-b490-c2ce1b500a61","title":"Bot Framework in Node.js - Calling Microsoft Graph (part 6)","slug":"/azurebot-nodejs-part6/","link":null,"excerpt":"I the previous post, we created a new Azure AD Application registration, gave it permissions to…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"March 22, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/fb02b1615213cb512da7d1c78b9ad995/19188/botframework6.png","srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/db297/botframework6.png 190w,\n/static/fb02b1615213cb512da7d1c78b9ad995/19188/botframework6.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/228d6/botframework6.webp 190w,\n/static/fb02b1615213cb512da7d1c78b9ad995/6b99c/botframework6.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/fb02b1615213cb512da7d1c78b9ad995/5fb32/botframework6.png","srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/739fd/botframework6.png 600w,\n/static/fb02b1615213cb512da7d1c78b9ad995/5fb32/botframework6.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/288e3/botframework6.webp 600w,\n/static/fb02b1615213cb512da7d1c78b9ad995/5b893/botframework6.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"31e75b40-8c93-54fb-bbfe-58e742083902","title":"Bot Framework in Node.js - Auth and Microsoft Graph (part 5)","slug":"/azurebot-nodejs-part5/","link":null,"excerpt":"In the previous post, we had a look at user interruptions. In this post, we will look at how to…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"March 13, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/d069abc39a202859cea11fc120ae11c0/19188/botframework5.png","srcSet":"/static/d069abc39a202859cea11fc120ae11c0/db297/botframework5.png 190w,\n/static/d069abc39a202859cea11fc120ae11c0/19188/botframework5.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/d069abc39a202859cea11fc120ae11c0/228d6/botframework5.webp 190w,\n/static/d069abc39a202859cea11fc120ae11c0/6b99c/botframework5.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/d069abc39a202859cea11fc120ae11c0/5fb32/botframework5.png","srcSet":"/static/d069abc39a202859cea11fc120ae11c0/739fd/botframework5.png 600w,\n/static/d069abc39a202859cea11fc120ae11c0/5fb32/botframework5.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/d069abc39a202859cea11fc120ae11c0/288e3/botframework5.webp 600w,\n/static/d069abc39a202859cea11fc120ae11c0/5b893/botframework5.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"084e9867-ec33-5a14-9e1f-d91f4280dac2","title":"Azure AD & Microsoft Graph OAuth Connection, with Azure CLI","slug":"/azcli-connection/","link":null,"excerpt":"In the previous post  Azure AD & Microsoft Graph permission scopes, with Azure CLI , we registered…","timeToRead":1,"featured":null,"thumbnailText":null,"date":"March 11, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/fba499085724398a27f00be5af554b7e/19188/azcli-connection.png","srcSet":"/static/fba499085724398a27f00be5af554b7e/db297/azcli-connection.png 190w,\n/static/fba499085724398a27f00be5af554b7e/19188/azcli-connection.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/fba499085724398a27f00be5af554b7e/228d6/azcli-connection.webp 190w,\n/static/fba499085724398a27f00be5af554b7e/6b99c/azcli-connection.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/fba499085724398a27f00be5af554b7e/5fb32/azcli-connection.png","srcSet":"/static/fba499085724398a27f00be5af554b7e/739fd/azcli-connection.png 600w,\n/static/fba499085724398a27f00be5af554b7e/5fb32/azcli-connection.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/fba499085724398a27f00be5af554b7e/288e3/azcli-connection.webp 600w,\n/static/fba499085724398a27f00be5af554b7e/5b893/azcli-connection.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}}]},"categoryPosts":{"nodes":[{"id":"95bc278d-e498-54ab-9a09-4392f627a596","title":"Bot Framework in Node.js - Proactive messages and token validation","slug":"/azurebot-nodejs-part8/","link":null,"excerpt":"In the last post we got a little fancy using Adaptive cards in the Bot. We talked about workarounds…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 10, 2021","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/0011cc7c64bf6a7a48e29df018eb1adf/19188/botframework8.png","srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/db297/botframework8.png 190w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/19188/botframework8.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/228d6/botframework8.webp 190w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/6b99c/botframework8.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/0011cc7c64bf6a7a48e29df018eb1adf/5fb32/botframework8.png","srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/739fd/botframework8.png 600w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/5fb32/botframework8.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/288e3/botframework8.webp 600w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/5b893/botframework8.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"47fa3c51-0e3f-5954-bc51-298d260844de","title":"Bot Framework in Node.js - Adaptive Cards (part 7)","slug":"/azurebot-nodejs-part7/","link":null,"excerpt":"In the previous post, we added some helpers and enabled the user to call Microsoft Graph. We used…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 08, 2021","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/b8577e12e0c806356bde4bd7135e8bcf/19188/botframework7.png","srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/db297/botframework7.png 190w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/19188/botframework7.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/228d6/botframework7.webp 190w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/6b99c/botframework7.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/b8577e12e0c806356bde4bd7135e8bcf/5fb32/botframework7.png","srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/739fd/botframework7.png 600w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/5fb32/botframework7.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/288e3/botframework7.webp 600w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/5b893/botframework7.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"f22060a9-6d2c-5f4c-afb8-98a59bdcc540","title":"Microsoft Graph Presence API - top of mind scenarios","slug":"/graph-presence/","link":null,"excerpt":"The new presence API in Microsoft Graph is very popular. We've seen a lot of blog post where people…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 06, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/9349ac165f3b22a5d70d0a19c66bd235/19188/presence.png","srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/db297/presence.png 190w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/19188/presence.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/228d6/presence.webp 190w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/6b99c/presence.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/9349ac165f3b22a5d70d0a19c66bd235/945a8/presence.png","srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/17e9b/presence.png 800w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/945a8/presence.png 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"},"sources":[{"srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/c9f06/presence.webp 800w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/f47df/presence.webp 1600w","type":"image/webp","sizes":"(min-width: 1600px) 1600px, 100vw"}]},"width":1600,"height":650}}},{"id":"0ed2d4e8-d282-5d9c-b490-c2ce1b500a61","title":"Bot Framework in Node.js - Calling Microsoft Graph (part 6)","slug":"/azurebot-nodejs-part6/","link":null,"excerpt":"I the previous post, we created a new Azure AD Application registration, gave it permissions to…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"March 22, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/fb02b1615213cb512da7d1c78b9ad995/19188/botframework6.png","srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/db297/botframework6.png 190w,\n/static/fb02b1615213cb512da7d1c78b9ad995/19188/botframework6.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/228d6/botframework6.webp 190w,\n/static/fb02b1615213cb512da7d1c78b9ad995/6b99c/botframework6.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/fb02b1615213cb512da7d1c78b9ad995/5fb32/botframework6.png","srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/739fd/botframework6.png 600w,\n/static/fb02b1615213cb512da7d1c78b9ad995/5fb32/botframework6.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/288e3/botframework6.webp 600w,\n/static/fb02b1615213cb512da7d1c78b9ad995/5b893/botframework6.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"31e75b40-8c93-54fb-bbfe-58e742083902","title":"Bot Framework in Node.js - Auth and Microsoft Graph (part 5)","slug":"/azurebot-nodejs-part5/","link":null,"excerpt":"In the previous post, we had a look at user interruptions. In this post, we will look at how to…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"March 13, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/d069abc39a202859cea11fc120ae11c0/19188/botframework5.png","srcSet":"/static/d069abc39a202859cea11fc120ae11c0/db297/botframework5.png 190w,\n/static/d069abc39a202859cea11fc120ae11c0/19188/botframework5.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/d069abc39a202859cea11fc120ae11c0/228d6/botframework5.webp 190w,\n/static/d069abc39a202859cea11fc120ae11c0/6b99c/botframework5.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/d069abc39a202859cea11fc120ae11c0/5fb32/botframework5.png","srcSet":"/static/d069abc39a202859cea11fc120ae11c0/739fd/botframework5.png 600w,\n/static/d069abc39a202859cea11fc120ae11c0/5fb32/botframework5.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/d069abc39a202859cea11fc120ae11c0/288e3/botframework5.webp 600w,\n/static/d069abc39a202859cea11fc120ae11c0/5b893/botframework5.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"084e9867-ec33-5a14-9e1f-d91f4280dac2","title":"Azure AD & Microsoft Graph OAuth Connection, with Azure CLI","slug":"/azcli-connection/","link":null,"excerpt":"In the previous post  Azure AD & Microsoft Graph permission scopes, with Azure CLI , we registered…","timeToRead":1,"featured":null,"thumbnailText":null,"date":"March 11, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/fba499085724398a27f00be5af554b7e/19188/azcli-connection.png","srcSet":"/static/fba499085724398a27f00be5af554b7e/db297/azcli-connection.png 190w,\n/static/fba499085724398a27f00be5af554b7e/19188/azcli-connection.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/fba499085724398a27f00be5af554b7e/228d6/azcli-connection.webp 190w,\n/static/fba499085724398a27f00be5af554b7e/6b99c/azcli-connection.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/fba499085724398a27f00be5af554b7e/5fb32/azcli-connection.png","srcSet":"/static/fba499085724398a27f00be5af554b7e/739fd/azcli-connection.png 600w,\n/static/fba499085724398a27f00be5af554b7e/5fb32/azcli-connection.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/fba499085724398a27f00be5af554b7e/288e3/azcli-connection.webp 600w,\n/static/fba499085724398a27f00be5af554b7e/5b893/azcli-connection.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}}]},"previous":{"id":"58c8f931-3998-52b8-a7eb-ae83f647df5b","slug":"/azfunc-migrate/","title":"Azure Function migration from 2.0 to 3.0"},"next":{"id":"b87724d8-ffb9-57d9-9309-93f77352d9a3","slug":"/azurebot-nodejs-part4/","title":"Bot Framework in Node.js - Interruptions (Part 4)"}},"pageContext":{"id":"41732e06-3e2a-5b5c-93a7-e89f10c0bae6","categoryId":"64f10eaf-091c-555c-a28e-13a12e934b04","tagsIds":["4a3b863b-2ddd-5eae-8e53-b85dea2ea045"],"hasTags":true,"previousId":"58c8f931-3998-52b8-a7eb-ae83f647df5b","nextId":"b87724d8-ffb9-57d9-9309-93f77352d9a3","paginatePostsPage":true,"basePath":"/","services":{"algolia":true,"mailchimp":false,"disqus":false,"graphComment":true,"facebookComment":false},"siteUrl":"https://www.agrenpoint.com","mobileMenu":{"title":"Topics","items":[{"name":"Azure","slug":"/category/azure/"},{"name":"Endpoint management","slug":"/category/endpoint-management/"},{"name":"Microsoft 365","slug":"/category/microsoft-365/"}]},"darkMode":true,"includeExcerpt":true,"includeTimeToRead":true,"includeTableOfContents":true,"imageQuality":75,"currentDate":"2026-03-02"}},"staticQueryHashes":["1992822086","2409295108","2925947909"]}
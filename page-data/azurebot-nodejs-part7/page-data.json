{"componentChunkName":"component---packages-blog-gatsby-blog-core-src-templates-post-js","path":"/azurebot-nodejs-part7/","result":{"data":{"post":{"id":"47fa3c51-0e3f-5954-bc51-298d260844de","title":"Bot Framework in Node.js - Adaptive Cards (part 7)","slug":"/azurebot-nodejs-part7/","link":null,"excerpt":"In the previous post, we added some helpers and enabled the user to call Microsoft Graph. We used…","tableOfContents":{"items":[{"url":"#sourcecode","title":"Sourcecode"},{"url":"#prerequisites","title":"Prerequisites"},{"url":"#project-changes","title":"Project changes","items":[{"url":"#tsconfigjs","title":"tsconfig.js"},{"url":"#files-we-added","title":"Files we added"}]},{"url":"#adaptive-cards","title":"Adaptive cards"},{"url":"#botts","title":"bot.ts","items":[{"url":"#workaround","title":"Workaround"},{"url":"#cardfactory","title":"CardFactory"},{"url":"#sending-adaptive-cards","title":"Sending Adaptive Cards"},{"url":"#methods","title":"Methods"}]},{"url":"#sitedialogts","title":"siteDialog.ts","items":[{"url":"#removals","title":"Removals"},{"url":"#imports","title":"Imports"},{"url":"#sitetypestep","title":"siteTypeStep"},{"url":"#titlestep","title":"titleStep"},{"url":"#confirmstep","title":"confirmStep"},{"url":"#workaround-2","title":"Workaround 2"}]},{"url":"#next-step","title":"Next step"}]},"timeToRead":3,"featured":null,"protected":null,"thumbnailText":null,"date":"April 08, 2021","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"body":"var _excluded = [\"components\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (-1 !== e.indexOf(n)) continue; t[n] = r[n]; } return t; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"Bot Framework in Node.js - Adaptive Cards (part 7)\",\n  \"tags\": [\"botframework\", \"teams\", \"msgraph\", \"pnp\"],\n  \"thumbnail\": \"botframework7.png\",\n  \"author\": \"Simon Ågren\",\n  \"date\": \"2021-04-08T00:00:00.000Z\",\n  \"category\": \"Azure\",\n  \"slug\": \"azurebot-nodejs-part7\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"In the previous post, we added some helpers and enabled the user to call Microsoft Graph. We used examples with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"GraphClient\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"PnPJs Graph\"), \" for hooking into the Azure Bot Service auth flow. And we also added some validation to the dialog using Microsoft Graph.\"), mdx(\"p\", null, \"Now we will get a little fancy using Adaptive cards in the Bot. And if we want to use these in Microsoft Teams in prompts, it gets a little tricky. I will walk you through my ways of handling this.\"), mdx(\"h1\", {\n    \"id\": \"sourcecode\"\n  }, \"Sourcecode\"), mdx(\"p\", null, \"The finished source code: \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/simonagren/simon-blog-bot-v7\"\n  }, \"https://github.com/simonagren/simon-blog-bot-v7\")), mdx(\"h1\", {\n    \"id\": \"prerequisites\"\n  }, \"Prerequisites\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://aka.ms/Emulator-wiki-getting-started\"\n  }, \"Bot Emulator\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://nodejs.org/en/download/\"\n  }, \"Node.js 10.4+\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://code.visualstudio.com/\"\n  }, \"Visual Studio Code\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://azure.microsoft.com/free/\"\n  }, \"An Azure Account\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://developer.microsoft.com/office/dev-program\"\n  }, \"Office 365 dev tenant\"), \" - for Microsoft Teams\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://ngrok.com/download\"\n  }, \"Ngrok\"))), mdx(\"h1\", {\n    \"id\": \"project-changes\"\n  }, \"Project changes\"), mdx(\"h2\", {\n    \"id\": \"tsconfigjs\"\n  }, \"tsconfig.js\"), mdx(\"p\", null, \"I\\u2019ve added two options in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"tsconfig\"), \" file that enable us to use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"import\"), \" when it comes to JSON files. Without these, we would need to use a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"require\"), \" syntax.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"\\\"resolveJsonModule\\\": true,\\n\\\"esModuleInterop\\\": true,\\n\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"import WelcomeCard from '../resources/welcome.json';\\n\")), mdx(\"h2\", {\n    \"id\": \"files-we-added\"\n  }, \"Files we added\"), mdx(\"p\", null, \"In the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src\"), \" folder we create an additional folder: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"resources\"), \". The folder contains 4 new files:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"generic.json\"), \": a generic Adaptive Card in JSON format. We will use this when prompting the user. \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"siteTypes.json\"), \": three Adaptive Cards in an array. Used as a carousel to select site type. \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"summary.json\"), \": an Adaptive Card that will replace the summary text.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"welcome.json\"), \": an Adaptive Card that will replace the welcome message from the Bot.\")), mdx(\"h1\", {\n    \"id\": \"adaptive-cards\"\n  }, \"Adaptive cards\"), mdx(\"p\", null, \"It\\u2019s not in scope to teach you everything regarding what Adaptive Cards are. You can read more \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://adaptivecards.io/\"\n  }, \"Here\"), \". Essentially you create a JSON structure with semantic values. The text could be \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Large\"), \" and the color \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Accent\"), \" - you declare an approximate, then the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"host\"), \" renders the card. The Adaptive Card will look like native Teams, or Outlook, Cortana etc. You don\\u2019t care about font-sizes and pixels while creating the cards.\"), mdx(\"h1\", {\n    \"id\": \"botts\"\n  }, \"bot.ts\"), mdx(\"p\", null, \"As we saw in the first post, we get normal text responses from the user via \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"context.activity.text\"), \". Adaptive Card responses in Teams comes back via \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"context.activity.value\"), \".\\nWe need to be aware of this in general, but this also leads to workarounds for prompts in dialogs.\"), mdx(\"h2\", {\n    \"id\": \"workaround\"\n  }, \"Workaround\"), mdx(\"p\", null, \"A workaround that I normally use is to catch the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"context.activity.value\"), \" in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"OnMessage\"), \" method, and then set the empty \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"context.activity.text\"), \" with the value we got from \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"context.activity.value\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"if\\xA0(context.activity.text\\xA0===\\xA0undefined\\xA0&&\\xA0context.activity.value\\xA0)\\xA0{\\n    context.activity.text\\xA0=\\xA0JSON.stringify(context.activity.value);\\n}\\n\")), mdx(\"p\", null, \"This will not interrupt the normal flow. The Bot will, just as before, kick off the Main Dialog with the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"context\"), \" that we slightly adapt. It will work the same as if the user would just have entered a text response in a normal prompt.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"// Run the Dialog with the new message Activity.\\nawait (this.dialog as MainDialog).run(context, this.dialogState);\\n\")), mdx(\"h2\", {\n    \"id\": \"cardfactory\"\n  }, \"CardFactory\"), mdx(\"p\", null, \"We import \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"CardFactory\"), \" from \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"botbuilder\"), \". You could either paste an Adaptive Card JSON, or import the value from a file like I have done (less cluttering).\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"const welcomeCard = CardFactory.adaptiveCard(WelcomeCard);\\n\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"adaptiveCard\"), \" method creates an \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Attachment\"), \" object with the correct \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"content type\"), \" and the card JSON itself. For those of you familiar with these cards might have seen the content type before:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"'application/vnd.microsoft.card.adaptive'\\n\")), mdx(\"p\", null, \"And this is what the static method looks like\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"public static adaptiveCard(card: any): Attachment {\\n    return { contentType: CardFactory.contentTypes.adaptiveCard, content: card };\\n}\\n\")), mdx(\"h2\", {\n    \"id\": \"sending-adaptive-cards\"\n  }, \"Sending Adaptive Cards\"), mdx(\"p\", null, \"We change from just sending a message to send a card as an attachment. When using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"attachments\"), \" in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"context.sendActivity\"), \" it expects an array of attachments. So make sure you put the card into brackets.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"await context.sendActivity({ attachments: [welcomeCard] });\\n\")), mdx(\"h2\", {\n    \"id\": \"methods\"\n  }, \"Methods\"), mdx(\"h3\", {\n    \"id\": \"onmessage\"\n  }, \"OnMessage\"), mdx(\"p\", null, \"This is what OnMessage looks like now\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"this.onMessage(async (context, next) => {\\n      \\n    // If result comes from an Adaptive Card\\n    if\\xA0(context.activity.text\\xA0===\\xA0undefined\\xA0&&\\xA0context.activity.value\\xA0)\\xA0{\\n    context.activity.text\\xA0=\\xA0JSON.stringify(context.activity.value);\\n    }\\n\\n    // Run the Dialog with the new message Activity.\\n    await (this.dialog as MainDialog).run(context, this.dialogState);\\n\\n    // By calling next() you ensure that the next BotHandler is run.\\n    await next();\\n});\\n\")), mdx(\"h3\", {\n    \"id\": \"onmembersadded\"\n  }, \"OnMembersAdded\"), mdx(\"p\", null, \"This is what OnMembersAdded looks like now\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"this.onMembersAdded(async (context, next) => {\\n    const membersAdded = context.activity.membersAdded;\\n    const welcomeCard = CardFactory.adaptiveCard(WelcomeCard);\\n    for (const member of membersAdded) {\\n    if (member.id !== context.activity.recipient.id) {\\n        await context.sendActivity({ attachments: [welcomeCard] });\\n    }\\n    }\\n    // By calling next() you ensure that the next BotHandler is run.\\n    await next();\\n});\\n\")), mdx(\"h1\", {\n    \"id\": \"sitedialogts\"\n  }, \"siteDialog.ts\"), mdx(\"h2\", {\n    \"id\": \"removals\"\n  }, \"Removals\"), mdx(\"p\", null, \"I removed \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"CHOICE_PROMPT\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"TITLE_PROMPT\"), \" constants, and also the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".addDialog()\"), \" for them.\"), mdx(\"h2\", {\n    \"id\": \"imports\"\n  }, \"Imports\"), mdx(\"p\", null, \"Imports from \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"botbuilder\"), \" for types and Attachment creation.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"import { Attachment, AttachmentLayoutTypes, CardFactory } from 'botbuilder';\\n\")), mdx(\"p\", null, \"Adaptive cards\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"import GenericCard from '../resources/generic.json';\\nimport SiteTypesCard from '../resources/siteTypes.json';\\nimport SummaryCard from '../resources/summary.json';\\n\")), mdx(\"h2\", {\n    \"id\": \"sitetypestep\"\n  }, \"siteTypeStep\"), mdx(\"p\", null, \"This step has changed from a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ChoicePrompt\"), \" to a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"TextPrompt\"), \". We will instead use the adaptive card \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"SiteTypesCard\"), \" for the choices. If you recall, it contains an array of three different adaptive cards in JSON-format. That\\u2019s why I\\u2019m using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".map()\"), \" to create an array of Attachments. We use a different \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"attachmentLayout\"), \" in the form of a carousel. \"), mdx(\"p\", null, \"We first send the Adaptive Card as an attachment. We then send a Text prompt - but with no text. The Text prompts makes sure we are waiting for user input. When the user clicks on one of the cards we will (through the workaround) catch the response and add it to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"siteDetails\"), \" just like before.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"private async siteTypeStep(stepContext: WaterfallStepContext): Promise<DialogTurnResult> {\\n    const siteDetails = stepContext.options as SiteDetails;\\n\\n    if (!siteDetails.siteType) {\\n\\n        const siteTypeCards: Attachment[] = SiteTypesCard.cards.map((card: any) => CardFactory.adaptiveCard(card));\\n        await stepContext.context.sendActivity({ \\n            attachmentLayout: AttachmentLayoutTypes.Carousel, \\n            attachments: siteTypeCards \\n        });\\n\\n        return await stepContext.prompt(TEXT_PROMPT, '');\\n\\n    } else {\\n        return await stepContext.next(siteDetails.siteType);\\n    }\\n}\\n\")), mdx(\"h2\", {\n    \"id\": \"titlestep\"\n  }, \"titleStep\"), mdx(\"p\", null, \"In this step the validation is removed. It was just an example that we don\\u2019t need. Now we are using a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"TEXT_PROMPT\"), \" here as well. \"), mdx(\"p\", null, \"We are using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"GenericCard\"), \" that was prepared with a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$Placeholder\"), \" variable. We will re-use this generic card in many of the steps and do a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".replace()\"), \" in the JSON with the \\u201Ctext value\\u201D we want to prompt the user. We first send the card and then prompt the user with an empty text value to await a response.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"private async titleStep(stepContext: WaterfallStepContext): Promise<DialogTurnResult> {\\n    const siteDetails = stepContext.options as SiteDetails;\\n\\n    siteDetails.siteType = stepContext.result.value;\\n\\n    if (!siteDetails.title) {\\n\\n        const promptText = `Provide a title for your ${siteDetails.siteType} site`;\\n        const titleCard: Attachment = CardFactory.adaptiveCard(JSON.parse(\\n            JSON.stringify(GenericCard).replace('$Placeholder', promptText)));\\n        \\n        await stepContext.context.sendActivity({ attachments: [titleCard] });\\n        return await stepContext.prompt(TEXT_PROMPT, '');\\n    } else {\\n        return await stepContext.next(siteDetails.title);\\n    }\\n}\\n\")), mdx(\"h2\", {\n    \"id\": \"confirmstep\"\n  }, \"confirmStep\"), mdx(\"p\", null, \"This step uses the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"SummaryCard\"), \" that I prepared with multiple placeholder values. Worth noting is that it\\u2019s still a ConfirmPrompt.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"private async confirmStep(stepContext: WaterfallStepContext): Promise<DialogTurnResult> {\\n    const siteDetails = stepContext.options as SiteDetails;\\n\\n    // Capture the results of the previous step\\n    siteDetails.alias = stepContext.result;\\n    \\n    const summaryCard: Attachment = CardFactory.adaptiveCard(JSON.parse(\\n        JSON.stringify(SummaryCard)\\n            .replace('$Title', siteDetails.title)\\n            .replace('$Desc', siteDetails.description)\\n            .replace('$Owner', siteDetails.owner)\\n            .replace('$Type', siteDetails.siteType)\\n            .replace('$Alias', siteDetails.alias ? siteDetails.alias : '' )\\n            ));\\n\\n    await stepContext.context.sendActivity({ attachments: [summaryCard] });\\n\\n    // Offer a YES/NO prompt.\\n    return await stepContext.prompt(CONFIRM_PROMPT, { prompt: '' });\\n}\\n\")), mdx(\"h2\", {\n    \"id\": \"workaround-2\"\n  }, \"Workaround 2\"), mdx(\"p\", null, \"Another workaround would be to create your own Prompt class. \"), mdx(\"p\", null, \"I just created a prompt that extends the normal text prompt, and I override the onRecognize method to work with both \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"value\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"text\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, \"import\\xA0{\\xA0TextPrompt,\\xA0PromptOptions,\\xA0PromptRecognizerResult,\\xA0PromptValidator\\xA0}\\xA0from\\xA0\\\"botbuilder-dialogs\\\";\\nimport\\xA0{\\xA0TurnContext\\xA0}\\xA0from\\xA0\\\"botbuilder\\\";\\n\\nexport\\xA0class\\xA0AdaptiveTextPrompt\\xA0extends\\xA0TextPrompt\\xA0{\\n\\xA0\\xA0\\xA0\\xA0\\n    /**\\n\\xA0\\xA0\\xA0\\xA0\\xA0*\\xA0Creates\\xA0a\\xA0new\\xA0Adaptive\\xA0Card\\xA0TextPrompt\\xA0instance.\\n\\xA0\\xA0\\xA0\\xA0\\xA0*/\\n\\xA0\\xA0\\xA0\\xA0constructor(dialogId:\\xA0string,\\xA0validator?:\\xA0PromptValidator<string>){\\n\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0super(dialogId,\\xA0validator);\\n\\xA0\\xA0\\xA0\\xA0}\\n\\xA0\\xA0\\xA0\\xA0\\n\\xA0\\xA0\\xA0\\xA0async\\xA0onRecognize(context:\\xA0TurnContext,\\xA0state:\\xA0any,\\xA0options:\\xA0PromptOptions):\\xA0Promise<PromptRecognizerResult<string>>\\xA0{\\xA0\\n\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0let\\xA0value:\\xA0any;\\n\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\n\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0if\\xA0(context.activity.text\\xA0===\\xA0undefined\\xA0&&\\xA0context.activity.value\\xA0)\\xA0{\\n\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0value\\xA0=\\xA0context.activity.value;\\xA0\\n\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0return\\xA0typeof\\xA0value\\xA0===\\xA0'object'\\xA0&&\\xA0value\\xA0!=\\xA0undefined\\xA0?\\xA0{\\xA0succeeded:\\xA0true,\\xA0value:\\xA0value\\xA0}\\xA0:\\xA0{\\xA0succeeded:\\xA0false\\xA0};\\n\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0}\\xA0\\n        else\\xA0if\\xA0(context.activity.value\\xA0===\\xA0undefined\\xA0&&\\xA0context.activity.text\\xA0)\\xA0{\\n\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0value\\xA0=\\xA0context.activity.text;\\n\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0return\\xA0typeof\\xA0value\\xA0===\\xA0'string'\\xA0&&\\xA0value.length\\xA0>\\xA00\\xA0?\\xA0{\\xA0succeeded:\\xA0true,\\xA0value:\\xA0value\\xA0}\\xA0:\\xA0{\\xA0succeeded:\\xA0false\\xA0};\\n\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0}\\n\\xA0\\xA0\\xA0\\xA0}\\n}\\n\")), mdx(\"h1\", {\n    \"id\": \"next-step\"\n  }, \"Next step\"), mdx(\"p\", null, \"In this post, we looked at using Adaptive Cards in our prompts.\"), mdx(\"p\", null, \"In the next post, we will use proactive messaging in a secure manner.\"));\n}\n;\nMDXContent.isMDXComponent = true;","keywords":null,"tags":[{"id":"4a3b863b-2ddd-5eae-8e53-b85dea2ea045","name":"botframework","slug":"/tag/botframework/"},{"id":"ebfba2f8-5479-5edb-b0af-a656cd15bfa4","name":"teams","slug":"/tag/teams/"},{"id":"3854a95d-b2b2-52b0-a0d7-8e558721d1e6","name":"msgraph","slug":"/tag/msgraph/"},{"id":"6713309e-fa1a-584b-960e-f8bec674ab65","name":"pnp","slug":"/tag/pnp/"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/b8577e12e0c806356bde4bd7135e8bcf/19188/botframework7.png","srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/db297/botframework7.png 190w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/19188/botframework7.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/228d6/botframework7.webp 190w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/6b99c/botframework7.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/b8577e12e0c806356bde4bd7135e8bcf/5fb32/botframework7.png","srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/739fd/botframework7.png 600w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/5fb32/botframework7.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/b8577e12e0c806356bde4bd7135e8bcf/288e3/botframework7.webp 600w,\n/static/b8577e12e0c806356bde4bd7135e8bcf/5b893/botframework7.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},"tagCategoryPosts":{"nodes":[{"id":"95bc278d-e498-54ab-9a09-4392f627a596","title":"Bot Framework in Node.js - Proactive messages and token validation","slug":"/azurebot-nodejs-part8/","link":null,"excerpt":"In the last post we got a little fancy using Adaptive cards in the Bot. We talked about workarounds…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 10, 2021","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/0011cc7c64bf6a7a48e29df018eb1adf/19188/botframework8.png","srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/db297/botframework8.png 190w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/19188/botframework8.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/228d6/botframework8.webp 190w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/6b99c/botframework8.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/0011cc7c64bf6a7a48e29df018eb1adf/5fb32/botframework8.png","srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/739fd/botframework8.png 600w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/5fb32/botframework8.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/288e3/botframework8.webp 600w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/5b893/botframework8.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"f22060a9-6d2c-5f4c-afb8-98a59bdcc540","title":"Microsoft Graph Presence API - top of mind scenarios","slug":"/graph-presence/","link":null,"excerpt":"The new presence API in Microsoft Graph is very popular. We've seen a lot of blog post where people…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 06, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/9349ac165f3b22a5d70d0a19c66bd235/19188/presence.png","srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/db297/presence.png 190w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/19188/presence.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/228d6/presence.webp 190w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/6b99c/presence.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/9349ac165f3b22a5d70d0a19c66bd235/945a8/presence.png","srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/17e9b/presence.png 800w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/945a8/presence.png 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"},"sources":[{"srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/c9f06/presence.webp 800w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/f47df/presence.webp 1600w","type":"image/webp","sizes":"(min-width: 1600px) 1600px, 100vw"}]},"width":1600,"height":650}}},{"id":"0ed2d4e8-d282-5d9c-b490-c2ce1b500a61","title":"Bot Framework in Node.js - Calling Microsoft Graph (part 6)","slug":"/azurebot-nodejs-part6/","link":null,"excerpt":"I the previous post, we created a new Azure AD Application registration, gave it permissions to…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"March 22, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/fb02b1615213cb512da7d1c78b9ad995/19188/botframework6.png","srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/db297/botframework6.png 190w,\n/static/fb02b1615213cb512da7d1c78b9ad995/19188/botframework6.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/228d6/botframework6.webp 190w,\n/static/fb02b1615213cb512da7d1c78b9ad995/6b99c/botframework6.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/fb02b1615213cb512da7d1c78b9ad995/5fb32/botframework6.png","srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/739fd/botframework6.png 600w,\n/static/fb02b1615213cb512da7d1c78b9ad995/5fb32/botframework6.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/288e3/botframework6.webp 600w,\n/static/fb02b1615213cb512da7d1c78b9ad995/5b893/botframework6.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"31e75b40-8c93-54fb-bbfe-58e742083902","title":"Bot Framework in Node.js - Auth and Microsoft Graph (part 5)","slug":"/azurebot-nodejs-part5/","link":null,"excerpt":"In the previous post, we had a look at user interruptions. In this post, we will look at how to…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"March 13, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/d069abc39a202859cea11fc120ae11c0/19188/botframework5.png","srcSet":"/static/d069abc39a202859cea11fc120ae11c0/db297/botframework5.png 190w,\n/static/d069abc39a202859cea11fc120ae11c0/19188/botframework5.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/d069abc39a202859cea11fc120ae11c0/228d6/botframework5.webp 190w,\n/static/d069abc39a202859cea11fc120ae11c0/6b99c/botframework5.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/d069abc39a202859cea11fc120ae11c0/5fb32/botframework5.png","srcSet":"/static/d069abc39a202859cea11fc120ae11c0/739fd/botframework5.png 600w,\n/static/d069abc39a202859cea11fc120ae11c0/5fb32/botframework5.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/d069abc39a202859cea11fc120ae11c0/288e3/botframework5.webp 600w,\n/static/d069abc39a202859cea11fc120ae11c0/5b893/botframework5.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"084e9867-ec33-5a14-9e1f-d91f4280dac2","title":"Azure AD & Microsoft Graph OAuth Connection, with Azure CLI","slug":"/azcli-connection/","link":null,"excerpt":"In the previous post  Azure AD & Microsoft Graph permission scopes, with Azure CLI , we registered…","timeToRead":1,"featured":null,"thumbnailText":null,"date":"March 11, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/fba499085724398a27f00be5af554b7e/19188/azcli-connection.png","srcSet":"/static/fba499085724398a27f00be5af554b7e/db297/azcli-connection.png 190w,\n/static/fba499085724398a27f00be5af554b7e/19188/azcli-connection.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/fba499085724398a27f00be5af554b7e/228d6/azcli-connection.webp 190w,\n/static/fba499085724398a27f00be5af554b7e/6b99c/azcli-connection.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/fba499085724398a27f00be5af554b7e/5fb32/azcli-connection.png","srcSet":"/static/fba499085724398a27f00be5af554b7e/739fd/azcli-connection.png 600w,\n/static/fba499085724398a27f00be5af554b7e/5fb32/azcli-connection.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/fba499085724398a27f00be5af554b7e/288e3/azcli-connection.webp 600w,\n/static/fba499085724398a27f00be5af554b7e/5b893/azcli-connection.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"d45b509b-06e7-5f59-9963-ab5041c1c9ec","title":"Azure AD & Microsoft Graph permission scopes, with Azure CLI","slug":"/azcli-adscope/","link":null,"excerpt":"In this small post, we will look at a scenario where we want to register an Azure AD Application…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"March 09, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/e5aceb9744ad9f189605a624aef5497e/19188/azcli-scopes.png","srcSet":"/static/e5aceb9744ad9f189605a624aef5497e/db297/azcli-scopes.png 190w,\n/static/e5aceb9744ad9f189605a624aef5497e/19188/azcli-scopes.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/e5aceb9744ad9f189605a624aef5497e/228d6/azcli-scopes.webp 190w,\n/static/e5aceb9744ad9f189605a624aef5497e/6b99c/azcli-scopes.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/e5aceb9744ad9f189605a624aef5497e/5fb32/azcli-scopes.png","srcSet":"/static/e5aceb9744ad9f189605a624aef5497e/739fd/azcli-scopes.png 600w,\n/static/e5aceb9744ad9f189605a624aef5497e/5fb32/azcli-scopes.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/e5aceb9744ad9f189605a624aef5497e/288e3/azcli-scopes.webp 600w,\n/static/e5aceb9744ad9f189605a624aef5497e/5b893/azcli-scopes.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}}]},"tagPosts":{"nodes":[{"id":"3775249d-bf27-553b-88e8-4f4354b2e1f5","title":"Custom Azure AD registration with Microsoft Graph PS","slug":"/custom-azure-ad-registration-with-microsoft-graph-ps/","link":null,"excerpt":"Introduction Similar to my post  PnP PowerShell - MFA account and Client Id  from a while back, I…","timeToRead":2,"featured":false,"thumbnailText":null,"date":"January 02, 2023","category":{"id":"b0babac0-675d-51af-aa7a-ce603b3a7af4","name":"Microsoft 365","slug":"/category/microsoft-365/","color":"#f25022","icon":"/static/363fdd53d34303b727d9dab161b8e88b/microsoft365.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/277677938ffc6d236164bf3a4fef9f3c/6b99c/image.webp","srcSet":"/static/277677938ffc6d236164bf3a4fef9f3c/228d6/image.webp 190w,\n/static/277677938ffc6d236164bf3a4fef9f3c/6b99c/image.webp 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/277677938ffc6d236164bf3a4fef9f3c/c9f06/image.webp","srcSet":"/static/277677938ffc6d236164bf3a4fef9f3c/6a2da/image.webp 400w,\n/static/277677938ffc6d236164bf3a4fef9f3c/c9f06/image.webp 800w","sizes":"(min-width: 800px) 800px, 100vw"},"sources":[]},"width":1600,"height":650}}},{"id":"47183d1a-665a-5630-b1f5-1120d6e50f33","title":"Microsoft Teams structure","slug":"/microsoft-teams-structure/","link":null,"excerpt":"Earlier, we have discussed why a governance strategy is essential, what usually happens without one…","timeToRead":3,"featured":true,"thumbnailText":null,"date":"December 13, 2021","category":{"id":"b0babac0-675d-51af-aa7a-ce603b3a7af4","name":"Microsoft 365","slug":"/category/microsoft-365/","color":"#f25022","icon":"/static/363fdd53d34303b727d9dab161b8e88b/microsoft365.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/static/8f7bf0d2a798e4f97970a3b1d257c007/19188/image.png","srcSet":"/static/8f7bf0d2a798e4f97970a3b1d257c007/db297/image.png 190w,\n/static/8f7bf0d2a798e4f97970a3b1d257c007/19188/image.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/8f7bf0d2a798e4f97970a3b1d257c007/228d6/image.webp 190w,\n/static/8f7bf0d2a798e4f97970a3b1d257c007/6b99c/image.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#e8e8e8","images":{"fallback":{"src":"/static/8f7bf0d2a798e4f97970a3b1d257c007/84e46/image.png","srcSet":"/static/8f7bf0d2a798e4f97970a3b1d257c007/dcb64/image.png 350w,\n/static/8f7bf0d2a798e4f97970a3b1d257c007/84e46/image.png 700w","sizes":"(min-width: 700px) 700px, 100vw"},"sources":[{"srcSet":"/static/8f7bf0d2a798e4f97970a3b1d257c007/14281/image.webp 350w,\n/static/8f7bf0d2a798e4f97970a3b1d257c007/aca1f/image.webp 700w","type":"image/webp","sizes":"(min-width: 700px) 700px, 100vw"}]},"width":1600,"height":649.1428571428572}}},{"id":"77167810-7af1-5dc0-a1dd-a11b4a6d0e57","title":"Microsoft Teams settings and policies quick overview","slug":"/microsoft-teams-settings-and-policies-quick-overview/","link":null,"excerpt":"I introduced some governance options and high-level thoughts regarding them. In this post, I want to…","timeToRead":3,"featured":true,"thumbnailText":null,"date":"November 29, 2021","category":{"id":"b0babac0-675d-51af-aa7a-ce603b3a7af4","name":"Microsoft 365","slug":"/category/microsoft-365/","color":"#f25022","icon":"/static/363fdd53d34303b727d9dab161b8e88b/microsoft365.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/a1be53d5d8210ae59ab87eacf533a8cd/144fe/image.jpg","srcSet":"/static/a1be53d5d8210ae59ab87eacf533a8cd/9d7b9/image.jpg 190w,\n/static/a1be53d5d8210ae59ab87eacf533a8cd/144fe/image.jpg 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/a1be53d5d8210ae59ab87eacf533a8cd/228d6/image.webp 190w,\n/static/a1be53d5d8210ae59ab87eacf533a8cd/6b99c/image.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/a1be53d5d8210ae59ab87eacf533a8cd/5e493/image.jpg","srcSet":"/static/a1be53d5d8210ae59ab87eacf533a8cd/696c0/image.jpg 800w,\n/static/a1be53d5d8210ae59ab87eacf533a8cd/5e493/image.jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"},"sources":[{"srcSet":"/static/a1be53d5d8210ae59ab87eacf533a8cd/c9f06/image.webp 800w,\n/static/a1be53d5d8210ae59ab87eacf533a8cd/f47df/image.webp 1600w","type":"image/webp","sizes":"(min-width: 1600px) 1600px, 100vw"}]},"width":1600,"height":650}}},{"id":"d14c7057-fd15-5640-95d5-c157f55d2900","title":"Governance options overview for Microsoft 365 and Teams","slug":"/governance-options-overview-for-microsoft-365-and-teams/","link":null,"excerpt":"I introduced some high-level thoughts on a governance strategy and its importance in the previous…","timeToRead":4,"featured":true,"thumbnailText":null,"date":"November 15, 2021","category":{"id":"b0babac0-675d-51af-aa7a-ce603b3a7af4","name":"Microsoft 365","slug":"/category/microsoft-365/","color":"#f25022","icon":"/static/363fdd53d34303b727d9dab161b8e88b/microsoft365.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#484848","images":{"fallback":{"src":"/static/b7cd887809a8df737c6c319ac621d252/144fe/image.jpg","srcSet":"/static/b7cd887809a8df737c6c319ac621d252/9d7b9/image.jpg 190w,\n/static/b7cd887809a8df737c6c319ac621d252/144fe/image.jpg 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/b7cd887809a8df737c6c319ac621d252/228d6/image.webp 190w,\n/static/b7cd887809a8df737c6c319ac621d252/6b99c/image.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#484848","images":{"fallback":{"src":"/static/b7cd887809a8df737c6c319ac621d252/5e493/image.jpg","srcSet":"/static/b7cd887809a8df737c6c319ac621d252/696c0/image.jpg 800w,\n/static/b7cd887809a8df737c6c319ac621d252/5e493/image.jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"},"sources":[{"srcSet":"/static/b7cd887809a8df737c6c319ac621d252/c9f06/image.webp 800w,\n/static/b7cd887809a8df737c6c319ac621d252/f47df/image.webp 1600w","type":"image/webp","sizes":"(min-width: 1600px) 1600px, 100vw"}]},"width":1600,"height":650}}},{"id":"769a2ccd-fcfd-5c1c-93b5-190ec2dece54","title":"Why you need a governance strategy for Microsoft Teams and M365","slug":"/why-you-need-a-governance-strategy-for-microsoft-teams-and-m365/","link":null,"excerpt":"What is governance strategy? Simply put, governance strategy is about defining people, processes…","timeToRead":3,"featured":true,"thumbnailText":null,"date":"November 01, 2021","category":{"id":"b0babac0-675d-51af-aa7a-ce603b3a7af4","name":"Microsoft 365","slug":"/category/microsoft-365/","color":"#f25022","icon":"/static/363fdd53d34303b727d9dab161b8e88b/microsoft365.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#181818","images":{"fallback":{"src":"/static/d405897dbdc3f1a34e986c8f134dbf66/144fe/image.jpg","srcSet":"/static/d405897dbdc3f1a34e986c8f134dbf66/9d7b9/image.jpg 190w,\n/static/d405897dbdc3f1a34e986c8f134dbf66/144fe/image.jpg 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/d405897dbdc3f1a34e986c8f134dbf66/228d6/image.webp 190w,\n/static/d405897dbdc3f1a34e986c8f134dbf66/6b99c/image.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#181818","images":{"fallback":{"src":"/static/d405897dbdc3f1a34e986c8f134dbf66/5e493/image.jpg","srcSet":"/static/d405897dbdc3f1a34e986c8f134dbf66/696c0/image.jpg 800w,\n/static/d405897dbdc3f1a34e986c8f134dbf66/5e493/image.jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"},"sources":[{"srcSet":"/static/d405897dbdc3f1a34e986c8f134dbf66/c9f06/image.webp 800w,\n/static/d405897dbdc3f1a34e986c8f134dbf66/f47df/image.webp 1600w","type":"image/webp","sizes":"(min-width: 1600px) 1600px, 100vw"}]},"width":1600,"height":650}}},{"id":"49e2220d-3fd1-5575-b6c9-411f48106fbe","title":"PnP PowerShell - MFA account and Client Id","slug":"/pnp-powershell-mfa-account-and-client-id/","link":null,"excerpt":"The background of this post is that I got a question from a friend of mine. He was in a situation…","timeToRead":2,"featured":null,"thumbnailText":null,"date":"May 09, 2021","category":{"id":"b0babac0-675d-51af-aa7a-ce603b3a7af4","name":"Microsoft 365","slug":"/category/microsoft-365/","color":"#f25022","icon":"/static/363fdd53d34303b727d9dab161b8e88b/microsoft365.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#0878d8","images":{"fallback":{"src":"/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/19188/pnppsmfa.png","srcSet":"/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/db297/pnppsmfa.png 190w,\n/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/19188/pnppsmfa.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/228d6/pnppsmfa.webp 190w,\n/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/6b99c/pnppsmfa.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#0878d8","images":{"fallback":{"src":"/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/945a8/pnppsmfa.png","srcSet":"/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/17e9b/pnppsmfa.png 800w,\n/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/945a8/pnppsmfa.png 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"},"sources":[{"srcSet":"/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/c9f06/pnppsmfa.webp 800w,\n/static/2b3f18f10d74ac2dd7b40c9d152b1f9c/f47df/pnppsmfa.webp 1600w","type":"image/webp","sizes":"(min-width: 1600px) 1600px, 100vw"}]},"width":1600,"height":650}}}]},"categoryPosts":{"nodes":[{"id":"95bc278d-e498-54ab-9a09-4392f627a596","title":"Bot Framework in Node.js - Proactive messages and token validation","slug":"/azurebot-nodejs-part8/","link":null,"excerpt":"In the last post we got a little fancy using Adaptive cards in the Bot. We talked about workarounds…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 10, 2021","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/0011cc7c64bf6a7a48e29df018eb1adf/19188/botframework8.png","srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/db297/botframework8.png 190w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/19188/botframework8.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/228d6/botframework8.webp 190w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/6b99c/botframework8.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/0011cc7c64bf6a7a48e29df018eb1adf/5fb32/botframework8.png","srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/739fd/botframework8.png 600w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/5fb32/botframework8.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/0011cc7c64bf6a7a48e29df018eb1adf/288e3/botframework8.webp 600w,\n/static/0011cc7c64bf6a7a48e29df018eb1adf/5b893/botframework8.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"f22060a9-6d2c-5f4c-afb8-98a59bdcc540","title":"Microsoft Graph Presence API - top of mind scenarios","slug":"/graph-presence/","link":null,"excerpt":"The new presence API in Microsoft Graph is very popular. We've seen a lot of blog post where people…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"April 06, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/9349ac165f3b22a5d70d0a19c66bd235/19188/presence.png","srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/db297/presence.png 190w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/19188/presence.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/228d6/presence.webp 190w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/6b99c/presence.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/9349ac165f3b22a5d70d0a19c66bd235/945a8/presence.png","srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/17e9b/presence.png 800w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/945a8/presence.png 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"},"sources":[{"srcSet":"/static/9349ac165f3b22a5d70d0a19c66bd235/c9f06/presence.webp 800w,\n/static/9349ac165f3b22a5d70d0a19c66bd235/f47df/presence.webp 1600w","type":"image/webp","sizes":"(min-width: 1600px) 1600px, 100vw"}]},"width":1600,"height":650}}},{"id":"0ed2d4e8-d282-5d9c-b490-c2ce1b500a61","title":"Bot Framework in Node.js - Calling Microsoft Graph (part 6)","slug":"/azurebot-nodejs-part6/","link":null,"excerpt":"I the previous post, we created a new Azure AD Application registration, gave it permissions to…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"March 22, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/fb02b1615213cb512da7d1c78b9ad995/19188/botframework6.png","srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/db297/botframework6.png 190w,\n/static/fb02b1615213cb512da7d1c78b9ad995/19188/botframework6.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/228d6/botframework6.webp 190w,\n/static/fb02b1615213cb512da7d1c78b9ad995/6b99c/botframework6.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/fb02b1615213cb512da7d1c78b9ad995/5fb32/botframework6.png","srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/739fd/botframework6.png 600w,\n/static/fb02b1615213cb512da7d1c78b9ad995/5fb32/botframework6.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/fb02b1615213cb512da7d1c78b9ad995/288e3/botframework6.webp 600w,\n/static/fb02b1615213cb512da7d1c78b9ad995/5b893/botframework6.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"31e75b40-8c93-54fb-bbfe-58e742083902","title":"Bot Framework in Node.js - Auth and Microsoft Graph (part 5)","slug":"/azurebot-nodejs-part5/","link":null,"excerpt":"In the previous post, we had a look at user interruptions. In this post, we will look at how to…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"March 13, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/d069abc39a202859cea11fc120ae11c0/19188/botframework5.png","srcSet":"/static/d069abc39a202859cea11fc120ae11c0/db297/botframework5.png 190w,\n/static/d069abc39a202859cea11fc120ae11c0/19188/botframework5.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/d069abc39a202859cea11fc120ae11c0/228d6/botframework5.webp 190w,\n/static/d069abc39a202859cea11fc120ae11c0/6b99c/botframework5.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#3898d8","images":{"fallback":{"src":"/static/d069abc39a202859cea11fc120ae11c0/5fb32/botframework5.png","srcSet":"/static/d069abc39a202859cea11fc120ae11c0/739fd/botframework5.png 600w,\n/static/d069abc39a202859cea11fc120ae11c0/5fb32/botframework5.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/d069abc39a202859cea11fc120ae11c0/288e3/botframework5.webp 600w,\n/static/d069abc39a202859cea11fc120ae11c0/5b893/botframework5.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"084e9867-ec33-5a14-9e1f-d91f4280dac2","title":"Azure AD & Microsoft Graph OAuth Connection, with Azure CLI","slug":"/azcli-connection/","link":null,"excerpt":"In the previous post  Azure AD & Microsoft Graph permission scopes, with Azure CLI , we registered…","timeToRead":1,"featured":null,"thumbnailText":null,"date":"March 11, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/fba499085724398a27f00be5af554b7e/19188/azcli-connection.png","srcSet":"/static/fba499085724398a27f00be5af554b7e/db297/azcli-connection.png 190w,\n/static/fba499085724398a27f00be5af554b7e/19188/azcli-connection.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/fba499085724398a27f00be5af554b7e/228d6/azcli-connection.webp 190w,\n/static/fba499085724398a27f00be5af554b7e/6b99c/azcli-connection.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/fba499085724398a27f00be5af554b7e/5fb32/azcli-connection.png","srcSet":"/static/fba499085724398a27f00be5af554b7e/739fd/azcli-connection.png 600w,\n/static/fba499085724398a27f00be5af554b7e/5fb32/azcli-connection.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/fba499085724398a27f00be5af554b7e/288e3/azcli-connection.webp 600w,\n/static/fba499085724398a27f00be5af554b7e/5b893/azcli-connection.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}},{"id":"d45b509b-06e7-5f59-9963-ab5041c1c9ec","title":"Azure AD & Microsoft Graph permission scopes, with Azure CLI","slug":"/azcli-adscope/","link":null,"excerpt":"In this small post, we will look at a scenario where we want to register an Azure AD Application…","timeToRead":3,"featured":null,"thumbnailText":null,"date":"March 09, 2020","category":{"id":"64f10eaf-091c-555c-a28e-13a12e934b04","name":"Azure","slug":"/category/azure/","color":"#007fff","icon":"/static/660faf3683bb1a8489baa9402bf62165/azure.svg"},"author":{"id":"6f313320-531a-5f32-9a22-708cb7653896","name":"Simon Ågren","slug":"/author/simon-agren/","title":"CTA & Microsoft MVP","description":"Solving business problems with tech","skills":["Microsoft 365","Azure"],"social":[{"name":"Github","url":"https://github.com/simonagren"},{"name":"Twitter","url":"https://twitter.com/agrenpoint"},{"name":"Website","url":"https://agrenpoint.com"}],"thumbnail":{"__typename":"ImageSharp","ImageSharp_small":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ac0cb/simon-agren.jpg 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/73f48/simon-agren.jpg 96w","sizes":"48px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/a3542/simon-agren.webp 48w,\n/static/bdc8525039042bedd52c0cf7d15e8521/0f66d/simon-agren.webp 96w","type":"image/webp","sizes":"48px"}]},"width":48,"height":48},"ImageSharp_regular":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg","srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/f679f/simon-agren.jpg 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/78d3d/simon-agren.jpg 300w","sizes":"150px"},"sources":[{"srcSet":"/static/bdc8525039042bedd52c0cf7d15e8521/ae23d/simon-agren.webp 150w,\n/static/bdc8525039042bedd52c0cf7d15e8521/bd37b/simon-agren.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}},"thumbnail":{"__typename":"ImageSharp","ImageSharp_vertical":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/e5aceb9744ad9f189605a624aef5497e/19188/azcli-scopes.png","srcSet":"/static/e5aceb9744ad9f189605a624aef5497e/db297/azcli-scopes.png 190w,\n/static/e5aceb9744ad9f189605a624aef5497e/19188/azcli-scopes.png 380w","sizes":"(min-width: 380px) 380px, 100vw"},"sources":[{"srcSet":"/static/e5aceb9744ad9f189605a624aef5497e/228d6/azcli-scopes.webp 190w,\n/static/e5aceb9744ad9f189605a624aef5497e/6b99c/azcli-scopes.webp 380w","type":"image/webp","sizes":"(min-width: 380px) 380px, 100vw"}]},"width":380,"height":290},"ImageSharp_hero":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/e5aceb9744ad9f189605a624aef5497e/5fb32/azcli-scopes.png","srcSet":"/static/e5aceb9744ad9f189605a624aef5497e/739fd/azcli-scopes.png 600w,\n/static/e5aceb9744ad9f189605a624aef5497e/5fb32/azcli-scopes.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/e5aceb9744ad9f189605a624aef5497e/288e3/azcli-scopes.webp 600w,\n/static/e5aceb9744ad9f189605a624aef5497e/5b893/azcli-scopes.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1600,"height":650.6666666666666}}}]},"previous":{"id":"f22060a9-6d2c-5f4c-afb8-98a59bdcc540","slug":"/graph-presence/","title":"Microsoft Graph Presence API - top of mind scenarios"},"next":{"id":"95bc278d-e498-54ab-9a09-4392f627a596","slug":"/azurebot-nodejs-part8/","title":"Bot Framework in Node.js - Proactive messages and token validation"}},"pageContext":{"id":"47fa3c51-0e3f-5954-bc51-298d260844de","categoryId":"64f10eaf-091c-555c-a28e-13a12e934b04","tagsIds":["4a3b863b-2ddd-5eae-8e53-b85dea2ea045","ebfba2f8-5479-5edb-b0af-a656cd15bfa4","3854a95d-b2b2-52b0-a0d7-8e558721d1e6","6713309e-fa1a-584b-960e-f8bec674ab65"],"hasTags":true,"previousId":"f22060a9-6d2c-5f4c-afb8-98a59bdcc540","nextId":"95bc278d-e498-54ab-9a09-4392f627a596","paginatePostsPage":true,"basePath":"/","services":{"algolia":true,"mailchimp":false,"disqus":false,"graphComment":true,"facebookComment":false},"siteUrl":"https://www.agrenpoint.com","mobileMenu":{"title":"Topics","items":[{"name":"Azure","slug":"/category/azure/"},{"name":"Endpoint management","slug":"/category/endpoint-management/"},{"name":"Microsoft 365","slug":"/category/microsoft-365/"}]},"darkMode":true,"includeExcerpt":true,"includeTimeToRead":true,"includeTableOfContents":true,"imageQuality":75,"currentDate":"2026-03-02"}},"staticQueryHashes":["1992822086","2409295108","2925947909"]}